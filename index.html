<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ohm-Lab: Laboratorio Virtual de Ley de Ohm">
    <title>Ohm-Lab - Laboratorio Virtual</title>
    <style>
        :root {
            --color-primario: #1e3a8a;
            --color-secundario: #dc2626;
            --color-acento: #f59e0b;
            --color-exito: #10b981;
            --color-advertencia: #f59e0b;
            --color-error: #ef4444;
            --color-fondo: #f8fafc;
            --color-texto: #1e293b;
            --color-texto-claro: #64748b;
            --color-borde: #e2e8f0;
            --sombra-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --sombra-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --sombra-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --sombra-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            --sombra-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            --espaciado-xs: 0.5rem;
            --espaciado-sm: 1rem;
            --espaciado-md: 1.5rem;
            --espaciado-lg: 2rem;
            --espaciado-xl: 3rem;
            --fuente-principal: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--fuente-principal);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-attachment: fixed;
            color: var(--color-texto);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            padding: var(--espaciado-sm);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: var(--espaciado-xs);
        }
        
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: var(--espaciado-sm);
        }
        
        .logo-institucion {
            display: flex;
            align-items: center;
            gap: var(--espaciado-xs);
            flex: 1;
            min-width: 250px;
        }
        
        .logo-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.125rem;
            font-weight: bold;
            color: white;
            box-shadow: 0 4px 12px rgba(251, 191, 36, 0.4);
            flex-shrink: 0;
        }
        
        .institucion-info h1 {
            font-size: 1.125rem;
            font-weight: 700;
            margin-bottom: 0.125rem;
            line-height: 1.2;
        }
        
        .institucion-info p {
            font-size: 0.75rem;
            opacity: 0.9;
            line-height: 1.2;
        }
        
        .controls-container {
            display: flex;
            gap: var(--espaciado-sm);
            align-items: center;
            flex-wrap: wrap;
        }
        
        .mode-toggle {
            display: flex;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 50px;
            padding: 4px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .mode-btn {
            padding: 0.5rem var(--espaciado-md);
            border: none;
            background: transparent;
            color: white;
            cursor: pointer;
            border-radius: 50px;
            font-size: 0.8125rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .mode-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }
        
        .mode-btn.active {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #1e293b;
            box-shadow: 0 4px 15px rgba(251, 191, 36, 0.4);
            transform: scale(1.05);
        }
        
        .btn-reset {
            padding: 0.5rem var(--espaciado-md);
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(239, 68, 68, 0.2);
            color: white;
            cursor: pointer;
            border-radius: 10px;
            font-size: 0.8125rem;
            font-weight: 700;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        
        .btn-reset:hover {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            border-color: rgba(239, 68, 68, 1);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.5);
        }
        
        .btn-reset:active {
            transform: translateY(-1px);
        }
        
        .app-title {
            text-align: center;
            padding: var(--espaciado-sm) 0;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .app-title h2 {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
            line-height: 1.2;
        }
        
        .app-subtitle {
            font-size: 0.875rem;
            opacity: 0.9;
        }
        
        .mode-indicator {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            margin-top: 0.375rem;
            color: #1e293b;
            box-shadow: 0 2px 8px rgba(251, 191, 36, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .progress-container {
            background: white;
            padding: var(--espaciado-md) var(--espaciado-sm);
            box-shadow: var(--sombra-md);
        }
        
        @media (max-width: 768px) {
            .progress-container {
                display: none;
            }
        }
        
        .progress-wrapper {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--espaciado-sm);
        }
        
        .progress-label {
            font-weight: 600;
            color: var(--color-texto);
            font-size: 0.875rem;
        }
        
        .progress-percentage {
            font-weight: 700;
            color: var(--color-primario);
            font-size: 1.25rem;
        }
        
        .progress-bar-bg {
            width: 100%;
            height: 12px;
            background: var(--color-borde);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--color-primario), var(--color-acento));
            border-radius: 10px;
            transition: width 0.5s ease;
            width: 0%;
        }
        
        .steps-navigation {
            background: white;
            padding: var(--espaciado-md) var(--espaciado-sm);
            box-shadow: var(--sombra-md);
            margin-bottom: var(--espaciado-lg);
        }
        
        .steps-nav-wrapper {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .steps-tabs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--espaciado-sm);
            margin-bottom: var(--espaciado-md);
        }
        
        .step-tab {
            background: white;
            border: 3px solid var(--color-borde);
            border-radius: 12px;
            padding: var(--espaciado-md);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--espaciado-xs);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }
        
        .step-tab:hover:not(.locked) {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.3);
            border-color: #667eea;
        }
        
        .step-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
            transform: scale(1.05);
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.4);
        }
        
        .step-tab.completed {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border-color: var(--color-exito);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        }
        
        .step-tab.locked {
            background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%);
            color: var(--color-texto-claro);
            border-color: #cbd5e1;
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: white;
            color: var(--color-primario);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.125rem;
        }
        
        .step-tab.active .step-number {
            color: var(--color-primario);
        }
        
        .step-tab.completed .step-number {
            color: var(--color-exito);
        }
        
        .step-tab.locked .step-number {
            color: #cbd5e1;
        }
        
        .step-title {
            font-weight: 600;
            font-size: 0.875rem;
            text-align: center;
        }
        
        .step-status {
            font-size: 1.5rem;
        }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            gap: var(--espaciado-sm);
        }
        
        .nav-btn {
            padding: var(--espaciado-sm) var(--espaciado-md);
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .nav-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: var(--sombra-md);
        }
        
        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-anterior {
            background: var(--color-texto-claro);
            color: white;
        }
        
        .btn-siguiente {
            background: var(--color-primario);
            color: white;
            margin-left: auto;
        }
        
        .main-container {
            flex: 1;
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
            padding: 0 var(--espaciado-sm) var(--espaciado-lg);
        }
        
        .step-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .step-section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .step-content {
            background: white;
            border-radius: 16px;
            padding: var(--espaciado-xl);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
            min-height: 400px;
            border: 3px solid rgba(102, 126, 234, 0.1);
        }
        
        .footer {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            padding: var(--espaciado-lg) var(--espaciado-sm);
            text-align: center;
            margin-top: auto;
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .footer p {
            font-size: 0.875rem;
            opacity: 0.9;
            margin-bottom: 0.5rem;
        }
        
        .footer-divider {
            width: 60px;
            height: 2px;
            background: rgba(255, 255, 255, 0.5);
            margin: var(--espaciado-md) auto;
        }
        
        .footer-universidad {
            margin-top: var(--espaciado-md);
            padding-top: var(--espaciado-md);
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .footer-universidad p {
            font-size: 0.875rem;
            margin-bottom: 0.25rem;
        }
        
        .footer-universidad .footer-institucion {
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }
        
        .footer-universidad .footer-programa {
            font-style: italic;
            opacity: 0.95;
        }
        
        .footer-universidad .footer-docente {
            font-weight: 600;
            margin-top: 0.5rem;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: var(--espaciado-md);
            margin-top: var(--espaciado-sm);
            flex-wrap: wrap;
        }
        
        .footer-link {
            color: white;
            text-decoration: none;
            font-size: 0.875rem;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }
        
        .footer-link:hover {
            opacity: 1;
            text-decoration: underline;
        }
        
        @media (max-width: 768px) {
            .header {
                padding: 0.5rem;
            }
            
            .header-content {
                gap: 0.375rem;
            }
            
            .header-top {
                flex-direction: column;
                align-items: stretch;
                gap: 0.5rem;
            }
            
            .logo-institucion {
                min-width: auto;
                gap: 0.5rem;
            }
            
            .logo-icon {
                width: 32px;
                height: 32px;
                font-size: 1rem;
            }
            
            .institucion-info h1 {
                font-size: 0.9375rem;
            }
            
            .institucion-info p {
                font-size: 0.6875rem;
            }
            
            .app-title {
                padding: 0.5rem 0;
            }
            
            .app-title h2 {
                font-size: 1rem;
                margin-bottom: 0.25rem;
            }
            
            .app-subtitle {
                font-size: 0.75rem;
            }
            
            .mode-indicator {
                font-size: 0.6875rem;
                padding: 0.25rem 0.625rem;
                margin-top: 0.25rem;
            }
            
            .controls-container {
                flex-direction: column;
                width: 100%;
                gap: 0.5rem;
            }
            
            .mode-toggle {
                width: 100%;
            }
            
            .mode-btn {
                flex: 1;
                font-size: 0.75rem;
                padding: 0.5rem 0.75rem;
            }
            
            .btn-reset {
                width: 100%;
                font-size: 0.75rem;
                padding: 0.5rem;
            }
            
            .progress-container {
                padding: 0.75rem 0.5rem;
            }
            
            .progress-label {
                font-size: 0.75rem;
            }
            
            .progress-percentage {
                font-size: 1rem;
            }
            
            .progress-bar-bg {
                height: 8px;
            }
            
            .steps-navigation {
                padding: 0.75rem 0.5rem;
                margin-bottom: var(--espaciado-md);
            }
            
            .steps-tabs {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.5rem;
            }
            
            .step-tab {
                padding: 0.75rem 0.5rem;
            }
            
            .step-number {
                width: 32px;
                height: 32px;
                font-size: 0.875rem;
                line-height: 32px;
            }
            
            .step-title {
                font-size: 0.75rem;
            }
            
            .step-status {
                font-size: 1.125rem;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .nav-btn {
                font-size: 0.875rem;
                padding: 0.75rem;
            }
            
            .btn-siguiente {
                margin-left: 0;
            }
            
            .main-container {
                padding: 0 0.5rem var(--espaciado-md);
            }
            
            .step-content {
                padding: var(--espaciado-md);
            }
            
            .intro-banner {
                padding: var(--espaciado-md);
                margin-bottom: var(--espaciado-md);
            }
            
            .intro-icon {
                font-size: 3rem;
                margin-bottom: 0.75rem;
            }
            
            .intro-banner h3 {
                font-size: 1.25rem;
                margin-bottom: 0.5rem;
            }
            
            .intro-banner p {
                font-size: 0.875rem;
            }
            
            .objetivos-section h4 {
                font-size: 1.125rem;
            }
            
            .objetivo-item {
                padding: 0.75rem;
            }
            
            .objetivo-icon {
                font-size: 1.25rem;
            }
            
            .concepto-card {
                padding: var(--espaciado-md);
            }
            
            .concepto-icon {
                font-size: 2rem;
            }
            
            .concepto-card h5 {
                font-size: 1rem;
            }
            
            .concepto-simbolo {
                font-size: 1.5rem;
            }
            
            .concepto-descripcion {
                font-size: 0.875rem;
            }
            
            .conceptos-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            
            .formula-container {
                padding: var(--espaciado-md);
                margin-bottom: var(--espaciado-md);
            }
            
            .formula-title {
                font-size: 1.125rem;
                margin-bottom: 0.75rem;
            }
            
            .formula-box {
                font-size: 1.75rem;
                padding: var(--espaciado-md);
                margin-bottom: 0.75rem;
            }
            
            .formula-explicacion {
                font-size: 0.875rem;
            }
            
            .form-group label {
                font-size: 0.875rem;
            }
            
            .form-group input,
            .form-group select {
                font-size: 0.875rem;
                padding: 0.75rem;
            }
            
            .btn-completar-paso {
                font-size: 0.9375rem;
                padding: 0.75rem;
            }
            
            .video-card {
                padding: var(--espaciado-md);
            }
            
            .video-icon {
                font-size: 2rem;
            }
            
            .video-card h5 {
                font-size: 0.9375rem;
            }
            
            .btn-video {
                font-size: 0.875rem;
                padding: 0.75rem;
            }
            
            .pregunta-item {
                padding: 0.75rem;
                margin-bottom: 0.75rem;
            }
            
            .pregunta-numero {
                width: 28px;
                height: 28px;
                font-size: 0.875rem;
                margin-right: 0.375rem;
            }
            
            .pregunta-label {
                font-size: 0.875rem;
                line-height: 1.5;
                margin-bottom: 0.75rem;
            }
            
            .opciones-container {
                gap: 0.5rem;
            }
            
            .opcion-item {
                padding: 0.75rem 0.5rem;
                flex-wrap: wrap;
            }
            
            .opcion-item input[type="radio"] {
                width: 20px;
                height: 20px;
                min-width: 20px;
            }
            
            .opcion-texto {
                font-size: 0.8125rem;
                line-height: 1.4;
            }
            
            .opcion-item.correcta::after,
            .opcion-item.incorrecta::after {
                font-size: 20px;
                margin-left: 0.375rem;
            }
            
            .retroalimentacion {
                padding: 0.75rem;
                margin-top: 0.5rem;
                font-size: 0.8125rem;
                line-height: 1.5;
            }
            
            .calculadora-container {
                padding: var(--espaciado-md);
                margin-bottom: var(--espaciado-md);
            }
            
            .calculadora-header h4 {
                font-size: 1.25rem;
                margin-bottom: 0.5rem;
            }
            
            .calculadora-header p {
                font-size: 0.875rem;
            }
            
            .formula-selector {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            
            .formula-btn {
                padding: 0.75rem;
                font-size: 0.9375rem;
            }
            
            .input-group label {
                font-size: 0.875rem;
                margin-bottom: 0.5rem;
            }
            
            .input-wrapper input {
                font-size: 0.9375rem;
                padding: 0.75rem;
            }
            
            .input-wrapper .unidad {
                font-size: 0.875rem;
                padding: 0 0.75rem;
            }
            
            .btn-calcular {
                padding: 0.875rem;
                font-size: 0.9375rem;
            }
            
            .resultado-valor {
                font-size: 2rem;
            }
            
            .resultado-formula {
                font-size: 0.9375rem;
            }
            
            .historial-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.75rem;
            }
            
            .historial-header h5 {
                font-size: 1.125rem;
            }
            
            .historial-botones {
                width: 100%;
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 0.5rem;
            }
            
            .btn-exportar-portafolio,
            .btn-limpiar-historial {
                font-size: 0.8125rem;
                padding: 0.625rem 0.75rem;
            }
            
            .estadisticas-panel {
                grid-template-columns: 1fr;
                gap: 0.75rem;
                padding: var(--espaciado-md);
            }
            
            .estadistica-card {
                padding: 0.75rem;
            }
            
            .estadistica-icon {
                font-size: 2rem;
                width: 48px;
                height: 48px;
            }
            
            .estadistica-valor {
                font-size: 1.5rem;
            }
            
            .estadistica-label {
                font-size: 0.75rem;
            }
            
            .historial-item {
                padding: 0.75rem;
                flex-direction: column;
                align-items: flex-start;
            }
            
            .historial-numero {
                width: 28px;
                height: 28px;
                line-height: 28px;
                font-size: 0.875rem;
                margin-right: 0.5rem;
            }
            
            .historial-formula {
                font-size: 0.9375rem;
            }
            
            .historial-detalles {
                font-size: 0.75rem;
            }
            
            .btn-eliminar-item {
                width: 100%;
                margin-top: 0.5rem;
                font-size: 0.8125rem;
                padding: 0.5rem;
            }
            
            .certificado-contenido {
                padding: var(--espaciado-md);
            }
            
            .certificado-titulo {
                font-size: 1.25rem;
            }
            
            .certificado-nombre {
                font-size: 1.5rem;
            }
            
            .certificado-texto-reconocimiento {
                padding: 0 var(--espaciado-sm);
                font-size: 0.875rem;
            }
            
            .certificado-footer {
                flex-direction: column;
                gap: var(--espaciado-md);
                align-items: center;
            }
            
            .footer {
                padding: var(--espaciado-md) 0.5rem;
            }
            
            .footer p {
                font-size: 0.75rem;
            }
            
            .footer-links {
                gap: 0.75rem;
            }
            
            .footer-link {
                font-size: 0.75rem;
            }
        }
        
        .intro-banner {
            text-align: center;
            padding: var(--espaciado-xl);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            color: white;
            margin-bottom: var(--espaciado-xl);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
            border: 3px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .intro-banner::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotateBg 20s linear infinite;
        }
        
        @keyframes rotateBg {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .intro-banner.modo-academico {
            background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 100%);
            box-shadow: 0 15px 40px rgba(15, 23, 42, 0.4);
        }
        
        .intro-icon {
            font-size: 5rem;
            margin-bottom: var(--espaciado-md);
            animation: pulse 2s ease-in-out infinite;
            position: relative;
            z-index: 1;
            filter: drop-shadow(0 8px 20px rgba(0, 0, 0, 0.3));
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }
        
        .intro-banner h3 {
            font-size: 2.5rem;
            margin-bottom: var(--espaciado-sm);
            position: relative;
            z-index: 1;
            text-shadow: 2px 4px 8px rgba(0, 0, 0, 0.3);
        }
        
        .intro-banner p {
            font-size: 1.25rem;
            opacity: 0.95;
            line-height: 1.8;
            position: relative;
            z-index: 1;
            text-shadow: 1px 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .objetivos-section {
            margin-bottom: var(--espaciado-xl);
        }
        
        .objetivos-section h4 {
            font-size: 1.5rem;
            color: var(--color-primario);
            margin-bottom: var(--espaciado-md);
            display: flex;
            align-items: center;
            gap: var(--espaciado-sm);
        }
        
        .objetivos-lista {
            display: grid;
            gap: var(--espaciado-md);
        }
        
        .objetivo-item {
            display: flex;
            align-items: flex-start;
            gap: var(--espaciado-sm);
            padding: var(--espaciado-lg);
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: 12px;
            border-left: 5px solid #667eea;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }
        
        .objetivo-item:hover {
            transform: translateX(8px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.2);
            border-left-width: 8px;
        }
        
        .objetivo-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }
        
        .objetivo-text {
            flex: 1;
        }
        
        .objetivo-text strong {
            color: var(--color-primario);
            display: block;
            margin-bottom: 0.25rem;
        }
        
        .conceptos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--espaciado-md);
            margin-bottom: var(--espaciado-xl);
        }
        
        .concepto-card {
            background: white;
            border: 2px solid var(--color-borde);
            border-radius: 12px;
            padding: var(--espaciado-lg);
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .concepto-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--sombra-lg);
            border-color: var(--color-primario);
        }
        
        .concepto-icon {
            font-size: 3rem;
            margin-bottom: var(--espaciado-sm);
        }
        
        .concepto-card h5 {
            font-size: 1.25rem;
            color: var(--color-primario);
            margin-bottom: var(--espaciado-xs);
        }
        
        .concepto-simbolo {
            font-size: 2rem;
            font-weight: 700;
            color: var(--color-acento);
            margin-bottom: var(--espaciado-sm);
            font-family: 'Courier New', monospace;
        }
        
        .concepto-descripcion {
            color: var(--color-texto-claro);
            margin-bottom: var(--espaciado-sm);
        }
        
        .concepto-unidad {
            font-weight: 600;
            color: var(--color-primario);
        }
        
        .formula-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: var(--espaciado-xl) * 1.5;
            border-radius: 20px;
            text-align: center;
            margin-bottom: var(--espaciado-xl);
            box-shadow: 0 20px 60px rgba(102, 126, 234, 0.4);
            border: 3px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .formula-container::before {
            content: '⚡';
            position: absolute;
            font-size: 15rem;
            opacity: 0.05;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-15deg);
        }
        
        .formula-title {
            font-size: 1.75rem;
            margin-bottom: var(--espaciado-md);
            position: relative;
            z-index: 1;
            text-shadow: 2px 4px 8px rgba(0, 0, 0, 0.3);
        }
        
        .formula-box {
            background: white;
            color: var(--color-texto);
            padding: var(--espaciado-xl);
            border-radius: 15px;
            font-size: 3rem;
            font-weight: 900;
            font-family: 'Courier New', monospace;
            margin-bottom: var(--espaciado-md);
            position: relative;
            z-index: 1;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border: 3px solid rgba(102, 126, 234, 0.2);
            animation: pulseFormula 3s ease-in-out infinite;
        }
        
        @keyframes pulseFormula {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .formula-explicacion {
            font-size: 1.125rem;
            opacity: 0.95;
            line-height: 1.8;
            position: relative;
            z-index: 1;
            text-shadow: 1px 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .registro-section {
            background: var(--color-fondo);
            padding: var(--espaciado-xl);
            border-radius: 12px;
            display: none;
            opacity: 0;
            transition: opacity 0.6s ease;
        }
        
        .registro-section.visible {
            display: block;
            opacity: 1;
        }
        
        .registro-section h4 {
            font-size: 1.5rem;
            color: var(--color-primario);
            margin-bottom: var(--espaciado-md);
            text-align: center;
        }
        
        .form-group {
            margin-bottom: var(--espaciado-md);
        }
        
        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: var(--espaciado-xs);
            color: var(--color-texto);
        }
        
        .required-field::after {
            content: ' *';
            color: var(--color-error);
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: var(--espaciado-sm);
            border: 2px solid var(--color-borde);
            border-radius: 8px;
            font-size: 1rem;
            font-family: var(--fuente-principal);
            transition: all 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--color-primario);
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
        }
        
        .form-group input.error,
        .form-group select.error {
            border-color: var(--color-error);
        }
        
        .error-message {
            color: var(--color-error);
            font-size: 0.875rem;
            margin-top: var(--espaciado-xs);
            display: none;
        }
        
        .error-message.visible {
            display: block;
        }
        
        .btn-completar-paso {
            width: 100%;
            padding: var(--espaciado-md);
            background: var(--color-exito);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.125rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-completar-paso:hover:not(:disabled) {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: var(--sombra-lg);
        }
        
        .btn-completar-paso:disabled {
            background: #cbd5e1;
            cursor: not-allowed;
        }
        
        .alert-box {
            padding: var(--espaciado-md);
            border-radius: 8px;
            margin-bottom: var(--espaciado-md);
            display: none;
        }
        
        .alert-box.visible {
            display: block;
        }
        
        .alert-box.success {
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            border: 3px solid var(--color-exito);
            color: #065f46;
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
        }
        
        .alert-box.error {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            border: 3px solid var(--color-error);
            color: #991b1b;
            box-shadow: 0 8px 20px rgba(239, 68, 68, 0.3);
        }
        
        .scroll-indicator {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 18px 28px;
            border-radius: 50px;
            font-weight: 700;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.5);
            z-index: 999;
            display: none;
            border: 3px solid rgba(255, 255, 255, 0.3);
            animation: bounceIn 0.6s ease;
        }
        
        @keyframes bounceIn {
            0% { transform: scale(0); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .scroll-indicator.visible {
            display: block;
            animation: pulse 2s ease-in-out infinite;
        }
        
        .video-section {
            margin-bottom: var(--espaciado-xl);
        }
        
        .video-info-box {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            padding: var(--espaciado-xl);
            border-radius: 20px;
            border: 3px solid rgba(102, 126, 234, 0.2);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: var(--espaciado-lg);
        }
        
        .videos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--espaciado-md);
            margin-bottom: var(--espaciado-lg);
        }
        
        .video-card {
            background: white;
            padding: var(--espaciado-lg);
            border-radius: 16px;
            border: 3px solid var(--color-borde);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            text-align: center;
        }
        
        .video-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.3);
            border-color: #667eea;
        }
        
        .video-icon {
            font-size: 3rem;
            margin-bottom: var(--espaciado-sm);
        }
        
        .video-card h5 {
            color: #667eea;
            font-size: 1.125rem;
            margin-bottom: var(--espaciado-sm);
            font-weight: 700;
        }
        
        .video-description {
            color: var(--color-texto-claro);
            font-size: 0.875rem;
            margin-bottom: var(--espaciado-md);
            line-height: 1.5;
        }
        
        .btn-video {
            width: 100%;
            background: linear-gradient(135deg, #FF0000 0%, #CC0000 100%);
            color: white;
            border: none;
            padding: var(--espaciado-sm) var(--espaciado-md);
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 700;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            box-shadow: 0 4px 15px rgba(255, 0, 0, 0.3);
        }
        
        .btn-video:hover {
            background: linear-gradient(135deg, #CC0000 0%, #990000 100%);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 0, 0, 0.4);
        }
        
        .video-warning {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            padding: var(--espaciado-md);
            border-radius: 12px;
            border: 2px solid var(--color-advertencia);
            color: #92400e;
            font-size: 0.875rem;
            line-height: 1.6;
            display: flex;
            align-items: center;
        }
        
        .video-confirmation {
            background: white;
            padding: var(--espaciado-lg);
            border-radius: 12px;
            border: 3px solid var(--color-borde);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }
        
        .checkbox-container {
            display: flex;
            align-items: center;
            gap: var(--espaciado-sm);
            cursor: pointer;
            user-select: none;
            font-size: 1.125rem;
            font-weight: 600;
            padding: var(--espaciado-sm);
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .checkbox-container:hover {
            background: var(--color-fondo);
        }
        
        .checkbox-container input[type="checkbox"] {
            display: none;
        }
        
        .checkmark {
            width: 32px;
            height: 32px;
            border: 3px solid var(--color-borde);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: white;
            flex-shrink: 0;
        }
        
        .checkbox-container input[type="checkbox"]:checked ~ .checkmark {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border-color: var(--color-exito);
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
        }
        
        .checkbox-container input[type="checkbox"]:checked ~ .checkmark::after {
            content: '✓';
            color: white;
            font-weight: bold;
            font-size: 1.5rem;
        }
        
        .checkbox-label {
            color: var(--color-texto);
        }
        
        .preguntas-section {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            padding: var(--espaciado-xl);
            border-radius: 20px;
            display: none;
            opacity: 0;
            transition: opacity 0.6s ease;
            border: 3px solid rgba(102, 126, 234, 0.2);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .preguntas-section.visible {
            display: block;
            opacity: 1;
        }
        
        .pregunta-item {
            background: white;
            padding: var(--espaciado-lg);
            border-radius: 16px;
            margin-bottom: var(--espaciado-lg);
            border: 3px solid var(--color-borde);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }
        
        .pregunta-item:hover {
            border-color: #667eea;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.2);
        }
        
        .pregunta-label {
            display: block;
            font-weight: 600;
            color: var(--color-texto);
            margin-bottom: var(--espaciado-md);
            font-size: 1.05rem;
            line-height: 1.6;
        }
        
        .pregunta-numero {
            display: inline-flex;
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin-right: var(--espaciado-xs);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        .opciones-container {
            display: flex;
            flex-direction: column;
            gap: var(--espaciado-sm);
        }
        
        .opcion-item {
            display: flex;
            align-items: center;
            gap: var(--espaciado-sm);
            padding: var(--espaciado-md);
            background: var(--color-fondo);
            border: 3px solid var(--color-borde);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .opcion-item:hover {
            background: #f1f5f9;
            border-color: #667eea;
            transform: translateX(5px);
        }
        
        .opcion-item input[type="radio"] {
            width: 22px;
            height: 22px;
            cursor: pointer;
            flex-shrink: 0;
            accent-color: #667eea;
        }
        
        .opcion-texto {
            flex: 1;
            line-height: 1.6;
            color: var(--color-texto);
            cursor: pointer;
        }
        
        .opcion-item.correcta {
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            border-color: var(--color-exito);
            border-width: 4px;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }
        
        .opcion-item.incorrecta {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            border-color: var(--color-error);
            border-width: 4px;
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
        }
        
        .opcion-item.correcta::after {
            content: '✓';
            font-size: 28px;
            font-weight: bold;
            color: var(--color-exito);
            margin-left: auto;
        }
        
        .opcion-item.incorrecta::after {
            content: '✗';
            font-size: 28px;
            font-weight: bold;
            color: var(--color-error);
            margin-left: auto;
        }
        
        .retroalimentacion {
            display: none;
            padding: var(--espaciado-md);
            border-radius: 12px;
            margin-top: var(--espaciado-sm);
            font-size: 0.9375rem;
            line-height: 1.6;
            animation: slideDown 0.4s ease;
            font-weight: 600;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .retroalimentacion.visible {
            display: block;
        }
        
        .retroalimentacion.correcta {
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            border: 3px solid var(--color-exito);
            color: #065f46;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }
        
        .retroalimentacion.incorrecta {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            border: 3px solid var(--color-error);
            color: #991b1b;
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
        }
        
        .calculadora-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 20px 60px rgba(102, 126, 234, 0.4);
            border: 3px solid rgba(255, 255, 255, 0.2);
        }
        
        .calculadora-header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }
        
        .calculadora-header h4 {
            font-size: 32px;
            margin-bottom: 16px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .calculadora-header p {
            font-size: 18px;
            opacity: 0.95;
        }
        
        .btn-modo-practica {
            padding: 16px 32px;
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #1e293b;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 6px 20px rgba(251, 191, 36, 0.4);
        }
        
        .btn-modo-practica:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(251, 191, 36, 0.5);
        }
        
        .problema-aleatorio {
            margin-top: 24px;
            padding: 24px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            border: 3px solid rgba(255, 255, 255, 0.5);
            display: none;
            animation: slideInDown 0.5s ease;
        }
        
        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .problema-aleatorio.visible {
            display: block;
        }
        
        .problema-icono {
            font-size: 48px;
            margin-bottom: 16px;
            text-align: center;
        }
        
        .problema-texto {
            font-size: 20px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 16px;
            line-height: 1.6;
        }
        
        .problema-respuesta {
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            padding: 16px;
            border-radius: 10px;
            border: 2px solid var(--color-exito);
            margin-top: 16px;
            display: none;
        }
        
        .problema-respuesta.visible {
            display: block;
            animation: bounceIn 0.5s ease;
        }
        
        .problema-solucion {
            font-size: 18px;
            font-weight: 700;
            color: #065f46;
            font-family: 'Courier New', monospace;
        }
        
        .btn-resolver-practica {
            margin-top: 16px;
            padding: 12px 24px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }
        
        .btn-resolver-practica:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 18px rgba(16, 185, 129, 0.4);
        }
        
        .formula-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 24px;
            margin-bottom: 40px;
        }
        
        .formula-btn {
            padding: 24px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            color: white;
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: 'Courier New', monospace;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .formula-btn:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }
        
        .formula-btn.active {
            background: white;
            color: #667eea;
            border-color: white;
            transform: scale(1.05);
            box-shadow: 0 8px 30px rgba(255, 255, 255, 0.4);
        }
        
        .calculadora-form {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }
        
        #inputs-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 24px;
            margin-bottom: 24px;
        }
        
        .input-group label {
            display: block;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .input-wrapper {
            display: flex;
            align-items: center;
            background: #f8fafc;
            border: 3px solid #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.4s ease;
        }
        
        .input-wrapper:focus-within {
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.15);
            transform: translateY(-2px);
        }
        
        .input-wrapper input {
            flex: 1;
            padding: 16px;
            border: none;
            background: transparent;
            font-size: 20px;
            font-weight: 600;
            color: #1e293b;
            outline: none;
        }
        
        .input-wrapper .unidad {
            padding: 0 16px;
            font-weight: 700;
            color: #764ba2;
            font-size: 18px;
            background: rgba(118, 75, 162, 0.1);
            height: 100%;
            display: flex;
            align-items: center;
        }
        
        .btn-calcular {
            width: 100%;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-calcular:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.5);
        }
        
        .resultado-container {
            margin-top: 32px;
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            padding: 32px;
            border-radius: 15px;
            text-align: center;
            display: none;
            box-shadow: 0 10px 40px rgba(251, 191, 36, 0.4);
            border: 3px solid rgba(255, 255, 255, 0.3);
        }
        
        .resultado-container.visible {
            display: block;
            animation: bounceIn 0.6s ease;
        }
        
        .resultado-label {
            font-size: 18px;
            font-weight: 600;
            color: rgba(0, 0, 0, 0.7);
            margin-bottom: 8px;
        }
        
        .resultado-valor {
            font-size: 48px;
            font-weight: 900;
            color: white;
            margin-bottom: 12px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            font-family: 'Courier New', monospace;
        }
        
        .resultado-formula {
            font-size: 20px;
            font-weight: 600;
            color: rgba(0, 0, 0, 0.8);
            font-family: 'Courier New', monospace;
        }
        
        .btn-agregar-historial {
            margin-top: 16px;
            padding: 16px 32px;
            background: white;
            color: #f59e0b;
            border: 3px solid white;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 4px 12px rgba(255, 255, 255, 0.3);
        }
        
        .btn-agregar-historial:hover {
            background: rgba(255, 255, 255, 0.95);
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 20px rgba(255, 255, 255, 0.4);
        }
        
        .historial-container {
            background: white;
            border-radius: 20px;
            padding: 32px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            border: 3px solid rgba(102, 126, 234, 0.1);
        }
        
        .historial-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 3px solid #e2e8f0;
            flex-wrap: wrap;
            gap: var(--espaciado-sm);
        }
        
        .historial-header h5 {
            font-size: 24px;
            color: #667eea;
            font-weight: 800;
        }
        
        .historial-botones {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .btn-exportar-portafolio {
            padding: 12px 24px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }
        
        .btn-exportar-portafolio:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);
        }
        
        .btn-exportar-portafolio:disabled {
            background: #cbd5e1;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .btn-limpiar-historial {
            padding: 12px 24px;
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }
        
        .btn-limpiar-historial:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(239, 68, 68, 0.4);
        }
        
        .estadisticas-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
            padding: 24px;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: 15px;
            border: 2px solid #bae6fd;
            display: none;
        }
        
        .estadisticas-panel.visible {
            display: grid;
        }
        
        .estadistica-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 16px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: all 0.4s ease;
            border: 3px solid rgba(102, 126, 234, 0.1);
        }
        
        .estadistica-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            border-color: #667eea;
        }
        
        .estadistica-icon {
            font-size: 40px;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        .estadistica-info {
            flex: 1;
        }
        
        .estadistica-valor {
            font-size: 32px;
            font-weight: 900;
            color: #667eea;
            line-height: 1;
            margin-bottom: 4px;
            font-family: 'Courier New', monospace;
        }
        
        .estadistica-label {
            font-size: 14px;
            font-weight: 600;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .historial-item {
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
            padding: 24px;
            border-radius: 12px;
            border-left: 5px solid #667eea;
            margin-bottom: 16px;
            transition: all 0.4s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: var(--espaciado-sm);
        }
        
        .historial-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }
        
        .historial-info {
            flex: 1;
        }
        
        .historial-numero {
            display: inline-block;
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 35px;
            font-weight: 700;
            margin-right: 12px;
        }
        
        .historial-formula {
            font-size: 18px;
            font-weight: 700;
            color: #1e3a8a;
            font-family: 'Courier New', monospace;
        }
        
        .historial-detalles {
            font-size: 14px;
            color: #64748b;
            margin-top: 8px;
        }
        
        .btn-eliminar-item {
            padding: 10px 20px;
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
        }
        
        .btn-eliminar-item:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);
        }
        
        .historial-vacio {
            text-align: center;
            padding: 48px;
            color: #64748b;
        }
        
        .historial-vacio-icon {
            font-size: 64px;
            margin-bottom: 24px;
            opacity: 0.5;
        }
        
        .certificado-section {
            display: none;
        }
        
        .certificado-section.visible {
            display: block;
            animation: fadeIn 0.8s ease;
        }
        
        .certificado-felicitaciones {
            text-align: center;
            padding: var(--espaciado-xl);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            color: white;
            margin-bottom: var(--espaciado-xl);
            box-shadow: 0 20px 60px rgba(102, 126, 234, 0.4);
            border: 3px solid rgba(255, 255, 255, 0.2);
        }
        
        .certificado-icon-grande {
            font-size: 5rem;
            margin-bottom: var(--espaciado-md);
            animation: bounceIn 1s ease;
        }
        
        @keyframes bounceIn {
            0% { transform: scale(0); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .certificado-felicitaciones h3 {
            font-size: 2.5rem;
            margin-bottom: var(--espaciado-sm);
        }
        
        .estadisticas-felicitacion {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--espaciado-md);
            margin-top: var(--espaciado-xl);
        }
        
        .stat-felicitacion {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: var(--espaciado-lg);
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .stat-felicitacion-icon {
            font-size: 2rem;
            margin-bottom: var(--espaciado-xs);
        }
        
        .stat-felicitacion-valor {
            font-size: 2rem;
            font-weight: 900;
            margin-bottom: var(--espaciado-xs);
        }
        
        .stat-felicitacion-label {
            font-size: 0.875rem;
            opacity: 0.9;
        }
        
        .certificado-preview {
            background: white;
            padding: var(--espaciado-xl);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            margin-bottom: var(--espaciado-xl);
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .certificado-contenido {
            padding: 40px 60px;
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-radius: 15px;
            border: 4px solid #667eea;
            min-height: 600px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .certificado-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .certificado-logo {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        
        .certificado-titulo {
            font-size: 2rem;
            color: #667eea;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .certificado-subtitulo {
            font-size: 1rem;
            color: #64748b;
        }
        
        .certificado-body {
            margin-bottom: 30px;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .certificado-texto-otorga {
            text-align: center;
            font-size: 1rem;
            color: #64748b;
            margin-bottom: 15px;
        }
        
        .certificado-nombre {
            text-align: center;
            font-size: 2.5rem;
            color: #1e3a8a;
            margin-bottom: 20px;
            font-weight: 900;
            text-transform: uppercase;
        }
        
        .certificado-texto-reconocimiento {
            text-align: center;
            font-size: 1rem;
            line-height: 1.6;
            color: #475569;
            margin-bottom: 30px;
            padding: 0 60px;
        }
        
        .certificado-detalles {
            display: flex;
            justify-content: center;
            gap: 50px;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }
        
        .certificado-detalle {
            text-align: center;
        }
        
        .certificado-detalle-label {
            font-size: 0.8rem;
            color: #64748b;
            display: block;
            margin-bottom: 5px;
        }
        
        .certificado-detalle-valor {
            font-size: 1.1rem;
            font-weight: 700;
            color: #1e3a8a;
        }
        
        .certificado-estadisticas {
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
        }
        
        .cert-stat {
            text-align: center;
        }
        
        .cert-stat-icon {
            font-size: 1.75rem;
            margin-bottom: 8px;
        }
        
        .cert-stat-valor {
            font-size: 1.25rem;
            font-weight: 900;
            color: #667eea;
            margin-bottom: 5px;
        }
        
        .cert-stat-label {
            font-size: 0.8rem;
            color: #64748b;
        }
        
        .certificado-footer {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #e2e8f0;
        }
        
        .certificado-firma {
            text-align: center;
        }
        
        .certificado-linea-firma {
            width: 200px;
            height: 2px;
            background: #1e3a8a;
            margin-bottom: 10px;
        }
        
        .certificado-nombre-firma {
            font-weight: 700;
            color: #1e3a8a;
            margin-bottom: 5px;
        }
        
        .certificado-institucion {
            font-size: 0.875rem;
            color: #64748b;
        }
        
        .certificado-sello {
            position: relative;
        }
        
        .sello-circular {
            width: 100px;
            height: 100px;
            border: 4px solid #667eea;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(102, 126, 234, 0.1);
        }
        
        .sello-texto {
            font-size: 0.75rem;
            font-weight: 900;
            color: #667eea;
            text-transform: uppercase;
        }
        
        .sello-anio {
            font-size: 1.25rem;
            font-weight: 900;
            color: #1e3a8a;
        }
        
        .certificado-codigo {
            text-align: center;
            margin-top: 30px;
            font-size: 0.75rem;
            color: #94a3b8;
        }
        
        .certificado-acciones {
            display: flex;
            justify-content: center;
            gap: var(--espaciado-md);
            flex-wrap: wrap;
        }
        
        .btn-descargar-certificado {
            padding: var(--espaciado-md) var(--espaciado-xl);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.125rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-descargar-certificado:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.5);
        }
        
        .btn-imprimir {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }
        
        .btn-imprimir:hover {
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.5);
        }
        
        @media print {
            body * { visibility: hidden; }
            .certificado-preview, .certificado-preview * { visibility: visible; }
            .certificado-preview { position: absolute; left: 0; top: 0; width: 100%; }
            .certificado-acciones { display: none !important; }
        }
        
        @media (max-width: 768px) {
            .certificado-contenido { padding: 40px 20px; }
            .certificado-nombre { font-size: 2rem; }
            .certificado-footer { flex-direction: column; gap: 30px; align-items: center; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="header-top">
                <div class="logo-institucion">
                    <div class="logo-icon">⚡</div>
                    <div class="institucion-info">
                        <h1>I.E.T.I. Nuestra Señora del Rosario</h1>
                        <p>Pitalito · Polonuevo, Atlántico · Colombia</p>
                    </div>
                </div>
                
                <div class="controls-container">
                    <div class="mode-toggle">
                        <button class="mode-btn active" data-mode="mision">
                            🎮 Modo Misión
                        </button>
                        <button class="mode-btn" data-mode="academico">
                            📚 Modo Académico
                        </button>
                    </div>
                    
                    <button class="btn-reset" id="btn-reset">
                        🔄 Reiniciar Todo
                    </button>
                </div>
            </div>
            
            <div class="app-title">
                <h2>⚡ Ohm-Lab: Mi Laboratorio Virtual</h2>
                <p class="app-subtitle">
                    <span id="subtitle-text">Una aventura con los Ohm-Vengers</span>
                </p>
                <span class="mode-indicator" id="mode-indicator">🎮 Modo Misión Activo</span>
            </div>
        </div>
    </header>
    
    <div class="progress-container">
        <div class="progress-wrapper">
            <div class="progress-info">
                <span class="progress-label">Progreso General</span>
                <span class="progress-percentage" id="progress-percentage">0%</span>
            </div>
            <div class="progress-bar-bg">
                <div class="progress-bar-fill" id="progress-bar-fill"></div>
            </div>
        </div>
    </div>
    
    <nav class="steps-navigation">
        <div class="steps-nav-wrapper">
            <div class="steps-tabs">
                <button class="step-tab active" data-step="1">
                    <span class="step-number">1</span>
                    <span class="step-title">Inicio</span>
                    <span class="step-status">🔵</span>
                </button>
                
                <button class="step-tab locked" data-step="2">
                    <span class="step-number">2</span>
                    <span class="step-title">Explorar</span>
                    <span class="step-status">🔒</span>
                </button>
                
                <button class="step-tab locked" data-step="3">
                    <span class="step-number">3</span>
                    <span class="step-title">Profundizar</span>
                    <span class="step-status">🔒</span>
                </button>
                
                <button class="step-tab locked" data-step="4">
                    <span class="step-number">4</span>
                    <span class="step-title">Cierre</span>
                    <span class="step-status">🔒</span>
                </button>
            </div>
            
            <div class="nav-buttons">
                <button class="nav-btn btn-anterior" id="btn-anterior" disabled>
                    ← Anterior
                </button>
                <button class="nav-btn btn-siguiente" id="btn-siguiente" disabled>
                    Siguiente →
                </button>
            </div>
        </div>
    </nav>
    
    <main class="main-container">
        <section class="step-section active" id="paso1">
            <div class="step-content">
                <div class="intro-banner" id="intro-banner">
                    <div class="intro-icon">⚡</div>
                    <h3 id="intro-title">¡Emergencia Eléctrica en la Ciudad!</h3>
                    <p id="intro-description">
                        La ciudad ha perdido el control de su red eléctrica. Los Ohm-Vengers necesitan 
                        tu ayuda para entender cómo funciona la electricidad y restaurar el orden. 
                        Tu misión: dominar la Ley de Ohm y convertirte en un superhéroe de la electricidad.
                    </p>
                </div>
                
                <div class="objetivos-section">
                    <h4>🎯 <span id="objetivos-title">Objetivos de tu Misión</span></h4>
                    <div class="objetivos-lista">
                        <div class="objetivo-item">
                            <span class="objetivo-icon">💡</span>
                            <div class="objetivo-text">
                                <strong>Comprender la Ley de Ohm</strong>
                                Entender la relación entre Voltaje (V), Corriente (I) y Resistencia (R)
                            </div>
                        </div>
                        <div class="objetivo-item">
                            <span class="objetivo-icon">🧮</span>
                            <div class="objetivo-text">
                                <strong>Aplicar fórmulas matemáticas</strong>
                                Calcular valores de V, I y R en diferentes situaciones prácticas
                            </div>
                        </div>
                        <div class="objetivo-item">
                            <span class="objetivo-icon">🔧</span>
                            <div class="objetivo-text">
                                <strong>Resolver problemas reales</strong>
                                Aplicar la Ley de Ohm a circuitos eléctricos del mundo real
                            </div>
                        </div>
                    </div>
                </div>
                
                <h4 style="font-size: 1.5rem; color: var(--color-primario); margin: var(--espaciado-xl) 0 var(--espaciado-md); text-align: center;">
                    📚 Los Tres Superhéroes de la Electricidad
                </h4>
                
                <div class="conceptos-grid">
                    <div class="concepto-card">
                        <div class="concepto-icon">🔋</div>
                        <h5>Voltaje</h5>
                        <div class="concepto-simbolo">V</div>
                        <p class="concepto-descripcion">
                            Es la "presión" eléctrica que impulsa a los electrones a moverse por el circuito.
                            Como la presión del agua en una tubería.
                        </p>
                        <p class="concepto-unidad">Unidad: Voltios (V)</p>
                    </div>
                    
                    <div class="concepto-card">
                        <div class="concepto-icon">⚡</div>
                        <h5>Corriente</h5>
                        <div class="concepto-simbolo">I</div>
                        <p class="concepto-descripcion">
                            Es el "flujo" de electrones que circula por el conductor.
                            Como la cantidad de agua que fluye por segundo.
                        </p>
                        <p class="concepto-unidad">Unidad: Amperios (A)</p>
                    </div>
                    
                    <div class="concepto-card">
                        <div class="concepto-icon">🛡️</div>
                        <h5>Resistencia</h5>
                        <div class="concepto-simbolo">R</div>
                        <p class="concepto-descripcion">
                            Es la "oposición" que presenta el material al paso de la corriente.
                            Como la fricción en la tubería.
                        </p>
                        <p class="concepto-unidad">Unidad: Ohmios (Ω)</p>
                    </div>
                </div>
                
                <div class="formula-container">
                    <div class="formula-title">⚡ La Fórmula Mágica: Ley de Ohm</div>
                    <div class="formula-box">V = I × R</div>
                    <p class="formula-explicacion">
                        <strong>Voltaje = Corriente × Resistencia</strong><br>
                        Esta fórmula te permite calcular cualquiera de las tres variables 
                        si conoces las otras dos. También puedes despejarla:<br>
                        <strong>I = V ÷ R</strong> &nbsp;|&nbsp; <strong>R = V ÷ I</strong>
                    </p>
                </div>
                
                <div class="registro-section" id="registro-section">
                    <h4>👤 <span id="registro-title">Registro de Superhéroe</span></h4>
                    
                    <div class="alert-box" id="alert-registro"></div>
                    
                    <form id="form-registro">
                        <div class="form-group">
                            <label for="nombre-estudiante" class="required-field">
                                Nombre completo
                            </label>
                            <input 
                                type="text" 
                                id="nombre-estudiante" 
                                placeholder="Escribe tu nombre completo"
                                required
                            >
                            <span class="error-message" id="error-nombre">
                                Por favor ingresa tu nombre completo
                            </span>
                        </div>
                        
                        <div class="form-group">
                            <label for="grado-estudiante" class="required-field">
                                Grado
                            </label>
                            <select id="grado-estudiante" required>
                                <option value="">Selecciona tu grado</option>
                                <option value="10">10° Grado</option>
                                <option value="11">11° Grado</option>
                            </select>
                            <span class="error-message" id="error-grado">
                                Por favor selecciona tu grado
                            </span>
                        </div>
                        
                        <button type="submit" class="btn-completar-paso" id="btn-completar-paso1">
                            ✅ <span id="btn-registro-text">Registrarme y Comenzar Misión</span>
                        </button>
                    </form>
                </div>
                
                <div id="scroll-indicator" class="scroll-indicator">
                    <span id="scroll-percentage">0%</span> completado
                </div>
            </div>
        </section>
        
        <section class="step-section" id="paso2">
            <div class="step-content">
                <div class="intro-banner" id="intro-banner-paso2">
                    <div class="intro-icon">🎥</div>
                    <h3 id="paso2-title">¡Hora del Entrenamiento!</h3>
                    <p id="paso2-description">
                        Antes de enfrentar los desafíos eléctricos, necesitas ver este video de entrenamiento.
                        Aprenderás cómo funciona realmente la Ley de Ohm en la práctica.
                    </p>
                </div>
                
                <div class="video-section">
                    <h4 style="font-size: 1.75rem; color: #667eea; margin-bottom: var(--espaciado-md); text-align: center; font-weight: 800;">
                        📺 Videos Educativos: Ley de Ohm
                    </h4>
                    
                    <div class="video-info-box">
                        <p style="color: var(--color-texto); font-size: 1.125rem; margin-bottom: var(--espaciado-lg); line-height: 1.6;">
                            📌 <strong>Debes ver al menos uno de estos videos en YouTube:</strong><br>
                            Haz clic en los botones para abrir el video en una nueva pestaña
                        </p>
                        
                        <div class="videos-grid">
                            <div class="video-card">
                                <div class="video-icon">🎬</div>
                                <h5>Video 1: Conceptos Fundamentales</h5>
                                <p class="video-description">
                                    Introducción completa a la Ley de Ohm y sus componentes principales
                                </p>
                                <button class="btn-video" onclick="window.open('https://www.youtube.com/watch?v=Az9YgKQ_UH4', '_blank')">
                                    ▶️ Ver en YouTube
                                </button>
                            </div>
                            
                            <div class="video-card">
                                <div class="video-icon">🎬</div>
                                <h5>Video 2: Aplicaciones Prácticas</h5>
                                <p class="video-description">
                                    Ejemplos reales y ejercicios resueltos de la Ley de Ohm
                                </p>
                                <button class="btn-video" onclick="window.open('https://www.youtube.com/watch?v=izDKIyCPRWE', '_blank')">
                                    ▶️ Ver en YouTube
                                </button>
                            </div>
                        </div>
                        
                        <div class="video-warning">
                            <span style="font-size: 1.5rem; margin-right: 0.5rem;">⚠️</span>
                            <strong>Importante:</strong> Estos videos se abrirán en YouTube. Asegúrate de verlos completamente antes de continuar con las preguntas.
                        </div>
                    </div>
                    
                    <div class="video-confirmation">
                        <label class="checkbox-container">
                            <input type="checkbox" id="video-visto">
                            <span class="checkmark"></span>
                            <span class="checkbox-label">✅ He visto el video completo</span>
                        </label>
                    </div>
                </div>
                
                <div class="preguntas-section" id="preguntas-section">
                    <h4 style="font-size: 1.75rem; color: #667eea; margin-bottom: var(--espaciado-md); text-align: center; font-weight: 800;">
                        💭 <span id="preguntas-title">Preguntas de Comprensión</span>
                    </h4>
                    
                    <div class="alert-box" id="alert-paso2"></div>
                    
                    <form id="form-preguntas">
                        <div class="pregunta-item">
                            <label class="pregunta-label">
                                <span class="pregunta-numero">1</span>
                                Según la Ley de Ohm, si en un circuito eléctrico aumentamos el voltaje y mantenemos constante la resistencia, ¿qué sucede con la corriente?
                            </label>
                            <div class="opciones-container">
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta1" value="A" required>
                                    <span class="opcion-texto">A. La corriente disminuye proporcionalmente</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta1" value="B">
                                    <span class="opcion-texto">B. La corriente aumenta proporcionalmente</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta1" value="C">
                                    <span class="opcion-texto">C. La corriente permanece constante</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta1" value="D">
                                    <span class="opcion-texto">D. La corriente se invierte</span>
                                </label>
                            </div>
                            <div class="retroalimentacion" id="retro-pregunta-1"></div>
                        </div>
                        
                        <div class="pregunta-item">
                            <label class="pregunta-label">
                                <span class="pregunta-numero">2</span>
                                Un circuito tiene una resistencia de 50 Ω y una corriente de 2 A. Aplicando la Ley de Ohm (V = I × R), ¿cuál es el voltaje del circuito?
                            </label>
                            <div class="opciones-container">
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta2" value="A" required>
                                    <span class="opcion-texto">A. 25 V</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta2" value="B">
                                    <span class="opcion-texto">B. 52 V</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta2" value="C">
                                    <span class="opcion-texto">C. 100 V</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta2" value="D">
                                    <span class="opcion-texto">D. 48 V</span>
                                </label>
                            </div>
                            <div class="retroalimentacion" id="retro-pregunta-2"></div>
                        </div>
                        
                        <div class="pregunta-item">
                            <label class="pregunta-label">
                                <span class="pregunta-numero">3</span>
                                ¿Cuál es la unidad de medida de la resistencia eléctrica?
                            </label>
                            <div class="opciones-container">
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta3" value="A" required>
                                    <span class="opcion-texto">A. Voltios (V)</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta3" value="B">
                                    <span class="opcion-texto">B. Amperios (A)</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta3" value="C">
                                    <span class="opcion-texto">C. Ohmios (Ω)</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta3" value="D">
                                    <span class="opcion-texto">D. Watts (W)</span>
                                </label>
                            </div>
                            <div class="retroalimentacion" id="retro-pregunta-3"></div>
                        </div>
                        
                        <div class="pregunta-item">
                            <label class="pregunta-label">
                                <span class="pregunta-numero">4</span>
                                Si en un circuito el voltaje es de 12 V y la resistencia es de 4 Ω, ¿cuál es la corriente que circula por el circuito? (Usa I = V ÷ R)
                            </label>
                            <div class="opciones-container">
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta4" value="A" required>
                                    <span class="opcion-texto">A. 48 A</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta4" value="B">
                                    <span class="opcion-texto">B. 8 A</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta4" value="C">
                                    <span class="opcion-texto">C. 3 A</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta4" value="D">
                                    <span class="opcion-texto">D. 16 A</span>
                                </label>
                            </div>
                            <div class="retroalimentacion" id="retro-pregunta-4"></div>
                        </div>
                        
                        <div class="pregunta-item">
                            <label class="pregunta-label">
                                <span class="pregunta-numero">5</span>
                                ¿Qué representa el voltaje en un circuito eléctrico según la analogía con el agua?
                            </label>
                            <div class="opciones-container">
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta5" value="A" required>
                                    <span class="opcion-texto">A. El ancho de la tubería</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta5" value="B">
                                    <span class="opcion-texto">B. La presión que impulsa el agua</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta5" value="C">
                                    <span class="opcion-texto">C. La cantidad de agua que fluye</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="pregunta5" value="D">
                                    <span class="opcion-texto">D. La fricción en la tubería</span>
                                </label>
                            </div>
                            <div class="retroalimentacion" id="retro-pregunta-5"></div>
                        </div>
                        
                        <button type="submit" class="btn-completar-paso" id="btn-completar-paso2" disabled>
                            ✅ Completar Paso 2 y Continuar
                        </button>
                    </form>
                </div>
            </div>
        </section>
        
        <section class="step-section" id="paso3">
            <div class="step-content">
                <div class="intro-banner" id="intro-banner-paso3">
                    <div class="intro-icon">🧮</div>
                    <h3 id="paso3-title">¡Hora de Practicar!</h3>
                    <p id="paso3-description">
                        Ahora que conoces la teoría, es momento de aplicar la Ley de Ohm.
                        Usa la calculadora interactiva para resolver problemas reales y construye tu portafolio de cálculos.
                    </p>
                </div>
                
                <div class="calculadora-container">
                    <div class="calculadora-header">
                        <h4>⚡ Calculadora de Ley de Ohm</h4>
                        <p>Selecciona la fórmula según lo que necesites calcular</p>
                    </div>
                    
                    <div style="text-align: center; margin-bottom: 24px;">
                        <button class="btn-modo-practica" id="btn-modo-practica">
                            🎲 Generar Problema Aleatorio
                        </button>
                        <div class="problema-aleatorio" id="problema-aleatorio"></div>
                    </div>
                    
                    <div class="formula-selector">
                        <button class="formula-btn active" data-formula="V">
                            V = I × R
                        </button>
                        <button class="formula-btn" data-formula="I">
                            I = V ÷ R
                        </button>
                        <button class="formula-btn" data-formula="R">
                            R = V ÷ I
                        </button>
                    </div>
                    
                    <form class="calculadora-form" id="form-calculadora">
                        <div id="inputs-container">
                            <div class="input-group">
                                <label for="input-I">Corriente (I) <span style="color: var(--color-error);">*</span></label>
                                <div class="input-wrapper">
                                    <input type="number" id="input-I" step="0.01" placeholder="Ej: 2.5" required>
                                    <span class="unidad">A</span>
                                </div>
                            </div>
                            
                            <div class="input-group">
                                <label for="input-R">Resistencia (R) <span style="color: var(--color-error);">*</span></label>
                                <div class="input-wrapper">
                                    <input type="number" id="input-R" step="0.01" placeholder="Ej: 100" required>
                                    <span class="unidad">Ω</span>
                                </div>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn-calcular">
                            🧮 Calcular Resultado
                        </button>
                    </form>
                    
                    <div class="resultado-container" id="resultado-container">
                        <div class="resultado-label">Resultado:</div>
                        <div class="resultado-valor" id="resultado-valor">0 V</div>
                        <div class="resultado-formula" id="resultado-formula">V = I × R</div>
                        <button class="btn-agregar-historial" id="btn-agregar-historial">
                            ➕ Agregar al Portafolio
                        </button>
                    </div>
                </div>
                
                <div class="historial-container">
                    <div class="historial-header">
                        <h5>📋 <span id="historial-title">Mi Portafolio de Cálculos</span></h5>
                        <div class="historial-botones">
                            <button class="btn-exportar-portafolio" id="btn-exportar-portafolio" disabled>
                                📥 Exportar
                            </button>
                            <button class="btn-limpiar-historial" id="btn-limpiar-historial">
                                🗑️ Limpiar
                            </button>
                        </div>
                    </div>
                    
                    <div class="estadisticas-panel" id="estadisticas-panel">
                        <div class="estadistica-card">
                            <div class="estadistica-icon">📊</div>
                            <div class="estadistica-info">
                                <div class="estadistica-valor" id="total-calculos">0</div>
                                <div class="estadistica-label">Cálculos</div>
                            </div>
                        </div>
                        
                        <div class="estadistica-card">
                            <div class="estadistica-icon">⭐</div>
                            <div class="estadistica-info">
                                <div class="estadistica-valor" id="formula-favorita">-</div>
                                <div class="estadistica-label">Más Usada</div>
                            </div>
                        </div>
                        
                        <div class="estadistica-card">
                            <div class="estadistica-icon">🕐</div>
                            <div class="estadistica-info">
                                <div class="estadistica-valor" id="ultimo-calculo">-</div>
                                <div class="estadistica-label">Último</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="historial-lista" id="historial-lista">
                        <div class="historial-vacio">
                            <div class="historial-vacio-icon">📊</div>
                            <p>Aún no has guardado ningún cálculo.</p>
                            <p style="font-size: 0.875rem; margin-top: var(--espaciado-xs);">
                                Realiza un cálculo y agrégalo a tu portafolio.
                            </p>
                        </div>
                    </div>
                </div>
                
                <div class="alert-box" id="alert-paso3"></div>
                
                <button class="btn-completar-paso" id="btn-completar-paso3" style="margin-top: var(--espaciado-lg);">
                    ✅ Completar Paso 3 y Continuar
                </button>
            </div>
        </section>
        
        <section class="step-section" id="paso4">
            <div class="step-content">
                <div class="intro-banner" id="intro-banner-paso4">
                    <div class="intro-icon">🏆</div>
                    <h3 id="paso4-title">¡Evaluación Final!</h3>
                    <p id="paso4-description">
                        Has llegado al último desafío. Responde 10 preguntas para demostrar todo lo que has aprendido sobre la Ley de Ohm y obtén tu certificado oficial.
                    </p>
                </div>
                
                <div class="evaluacion-final" id="evaluacion-final">
                    <h4 style="font-size: 1.75rem; color: #667eea; margin-bottom: var(--espaciado-md); text-align: center; font-weight: 800;">
                        📝 Evaluación Final
                    </h4>
                    <p style="text-align: center; color: var(--color-texto-claro); margin-bottom: var(--espaciado-xl); font-size: 1.125rem;">
                        Responde las siguientes 10 preguntas. Se requiere <strong>70% de aciertos</strong> para aprobar.
                    </p>
                    
                    <div class="alert-box" id="alert-paso4"></div>
                    
                    <form id="form-evaluacion-final">
                        <div class="pregunta-item">
                            <label class="pregunta-label">
                                <span class="pregunta-numero">1</span>
                                La Ley de Ohm establece que la corriente eléctrica que circula por un conductor es:
                            </label>
                            <div class="opciones-container">
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta1" value="A" required>
                                    <span class="opcion-texto">A. Inversamente proporcional al voltaje y directamente proporcional a la resistencia</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta1" value="B">
                                    <span class="opcion-texto">B. Directamente proporcional al voltaje e inversamente proporcional a la resistencia</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta1" value="C">
                                    <span class="opcion-texto">C. Independiente del voltaje y de la resistencia</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta1" value="D">
                                    <span class="opcion-texto">D. Igual al producto del voltaje por la resistencia</span>
                                </label>
                            </div>
                            <div class="retroalimentacion" id="eval-retro-1"></div>
                        </div>
                        
                        <div class="pregunta-item">
                            <label class="pregunta-label">
                                <span class="pregunta-numero">2</span>
                                Si en un circuito el voltaje es de 24 V y la resistencia es de 8 Ω, la corriente que circula es:
                            </label>
                            <div class="opciones-container">
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta2" value="A" required>
                                    <span class="opcion-texto">A. 192 A</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta2" value="B">
                                    <span class="opcion-texto">B. 16 A</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta2" value="C">
                                    <span class="opcion-texto">C. 3 A</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta2" value="D">
                                    <span class="opcion-texto">D. 32 A</span>
                                </label>
                            </div>
                            <div class="retroalimentacion" id="eval-retro-2"></div>
                        </div>
                        
                        <div class="pregunta-item">
                            <label class="pregunta-label">
                                <span class="pregunta-numero">3</span>
                                Un bombillo conectado a una fuente de 120 V consume una corriente de 0.5 A. Su resistencia es:
                            </label>
                            <div class="opciones-container">
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta3" value="A" required>
                                    <span class="opcion-texto">A. 60 Ω</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta3" value="B">
                                    <span class="opcion-texto">B. 120.5 Ω</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta3" value="C">
                                    <span class="opcion-texto">C. 240 Ω</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta3" value="D">
                                    <span class="opcion-texto">D. 119.5 Ω</span>
                                </label>
                            </div>
                            <div class="retroalimentacion" id="eval-retro-3"></div>
                        </div>
                        
                        <div class="pregunta-item">
                            <label class="pregunta-label">
                                <span class="pregunta-numero">4</span>
                                ¿Qué sucede con la corriente si duplicamos el voltaje y mantenemos constante la resistencia?
                            </label>
                            <div class="opciones-container">
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta4" value="A" required>
                                    <span class="opcion-texto">A. La corriente se reduce a la mitad</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta4" value="B">
                                    <span class="opcion-texto">B. La corriente se duplica</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta4" value="C">
                                    <span class="opcion-texto">C. La corriente permanece igual</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta4" value="D">
                                    <span class="opcion-texto">D. La corriente se cuadruplica</span>
                                </label>
                            </div>
                            <div class="retroalimentacion" id="eval-retro-4"></div>
                        </div>
                        
                        <div class="pregunta-item">
                            <label class="pregunta-label">
                                <span class="pregunta-numero">5</span>
                                La unidad de medida del voltaje en el Sistema Internacional es:
                            </label>
                            <div class="opciones-container">
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta5" value="A" required>
                                    <span class="opcion-texto">A. Amperio (A)</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta5" value="B">
                                    <span class="opcion-texto">B. Voltio (V)</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta5" value="C">
                                    <span class="opcion-texto">C. Ohmio (Ω)</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta5" value="D">
                                    <span class="opcion-texto">D. Watt (W)</span>
                                </label>
                            </div>
                            <div class="retroalimentacion" id="eval-retro-5"></div>
                        </div>
                        
                        <div class="pregunta-item">
                            <label class="pregunta-label">
                                <span class="pregunta-numero">6</span>
                                Si una resistencia de 20 Ω se conecta a un voltaje de 5 V, ¿cuánta corriente circulará?
                            </label>
                            <div class="opciones-container">
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta6" value="A" required>
                                    <span class="opcion-texto">A. 100 A</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta6" value="B">
                                    <span class="opcion-texto">B. 4 A</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta6" value="C">
                                    <span class="opcion-texto">C. 0.25 A</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta6" value="D">
                                    <span class="opcion-texto">D. 25 A</span>
                                </label>
                            </div>
                            <div class="retroalimentacion" id="eval-retro-6"></div>
                        </div>
                        
                        <div class="pregunta-item">
                            <label class="pregunta-label">
                                <span class="pregunta-numero">7</span>
                                ¿Qué representa físicamente la resistencia eléctrica en un circuito?
                            </label>
                            <div class="opciones-container">
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta7" value="A" required>
                                    <span class="opcion-texto">A. La facilidad con la que fluyen los electrones</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta7" value="B">
                                    <span class="opcion-texto">B. La oposición al paso de la corriente eléctrica</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta7" value="C">
                                    <span class="opcion-texto">C. La cantidad de energía que consume el circuito</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta7" value="D">
                                    <span class="opcion-texto">D. La velocidad de los electrones en el conductor</span>
                                </label>
                            </div>
                            <div class="retroalimentacion" id="eval-retro-7"></div>
                        </div>
                        
                        <div class="pregunta-item">
                            <label class="pregunta-label">
                                <span class="pregunta-numero">8</span>
                                Un circuito tiene una corriente de 3 A y una resistencia de 15 Ω. El voltaje aplicado es:
                            </label>
                            <div class="opciones-container">
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta8" value="A" required>
                                    <span class="opcion-texto">A. 5 V</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta8" value="B">
                                    <span class="opcion-texto">B. 18 V</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta8" value="C">
                                    <span class="opcion-texto">C. 45 V</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta8" value="D">
                                    <span class="opcion-texto">D. 12 V</span>
                                </label>
                            </div>
                            <div class="retroalimentacion" id="eval-retro-8"></div>
                        </div>
                        
                        <div class="pregunta-item">
                            <label class="pregunta-label">
                                <span class="pregunta-numero">9</span>
                                Si en un circuito reducimos la resistencia a la mitad manteniendo el voltaje constante, la corriente:
                            </label>
                            <div class="opciones-container">
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta9" value="A" required>
                                    <span class="opcion-texto">A. Se reduce a la mitad</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta9" value="B">
                                    <span class="opcion-texto">B. Se duplica</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta9" value="C">
                                    <span class="opcion-texto">C. Permanece constante</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta9" value="D">
                                    <span class="opcion-texto">D. Se reduce a un cuarto</span>
                                </label>
                            </div>
                            <div class="retroalimentacion" id="eval-retro-9"></div>
                        </div>
                        
                        <div class="pregunta-item">
                            <label class="pregunta-label">
                                <span class="pregunta-numero">10</span>
                                ¿Cuál de las siguientes fórmulas NO es una forma correcta de expresar la Ley de Ohm?
                            </label>
                            <div class="opciones-container">
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta10" value="A" required>
                                    <span class="opcion-texto">A. V = I × R</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta10" value="B">
                                    <span class="opcion-texto">B. I = V ÷ R</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta10" value="C">
                                    <span class="opcion-texto">C. R = V ÷ I</span>
                                </label>
                                <label class="opcion-item">
                                    <input type="radio" name="eval_pregunta10" value="D">
                                    <span class="opcion-texto">D. V = R ÷ I</span>
                                </label>
                            </div>
                            <div class="retroalimentacion" id="eval-retro-10"></div>
                        </div>
                        
                        <button type="submit" class="btn-completar-paso" id="btn-completar-paso4">
                            🏆 Enviar Evaluación Final
                        </button>
                    </form>
                </div>
                
                <div class="certificado-section" id="certificado-section">
                    <div class="certificado-felicitaciones">
                        <div class="certificado-icon-grande">🎓</div>
                        <h3>¡FELICITACIONES!</h3>
                        <p>Has completado exitosamente el Laboratorio Virtual de Ley de Ohm</p>
                        
                        <div class="estadisticas-felicitacion">
                            <div class="stat-felicitacion">
                                <div class="stat-felicitacion-icon">📊</div>
                                <div class="stat-felicitacion-valor" id="cert-nota-felicitacion">0/10</div>
                                <div class="stat-felicitacion-label">Evaluación</div>
                            </div>
                            <div class="stat-felicitacion">
                                <div class="stat-felicitacion-icon">🧮</div>
                                <div class="stat-felicitacion-valor" id="cert-calculos-felicitacion">0</div>
                                <div class="stat-felicitacion-label">Cálculos</div>
                            </div>
                            <div class="stat-felicitacion">
                                <div class="stat-felicitacion-icon">✅</div>
                                <div class="stat-felicitacion-valor">100%</div>
                                <div class="stat-felicitacion-label">Completado</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="certificado-preview" id="certificado-preview">
                        <div class="certificado-contenido">
                            <div class="certificado-header">
                                <div class="certificado-logo">⚡</div>
                                <h2 class="certificado-titulo">CERTIFICADO DE LOGRO</h2>
                                <p class="certificado-subtitulo">Laboratorio Virtual de Electricidad</p>
                            </div>
                            
                            <div class="certificado-body">
                                <p class="certificado-texto-otorga">Se otorga el presente certificado a:</p>
                                <h1 class="certificado-nombre" id="cert-nombre-estudiante">Nombre del Estudiante</h1>
                                <p class="certificado-texto-reconocimiento">
                                    Por haber completado satisfactoriamente el <strong>Laboratorio Virtual: 
                                    Ley de Ohm</strong>, demostrando comprensión de los conceptos fundamentales 
                                    de electricidad y circuitos eléctricos.
                                </p>
                                
                                <div class="certificado-detalles">
                                    <div class="certificado-detalle">
                                        <span class="certificado-detalle-label">Grado:</span>
                                        <span class="certificado-detalle-valor" id="cert-grado">10°</span>
                                    </div>
                                    <div class="certificado-detalle">
                                        <span class="certificado-detalle-label">Fecha:</span>
                                        <span class="certificado-detalle-valor" id="cert-fecha">-</span>
                                    </div>
                                    <div class="certificado-detalle">
                                        <span class="certificado-detalle-label">Calificación:</span>
                                        <span class="certificado-detalle-valor" id="cert-calificacion">0/10</span>
                                    </div>
                                </div>
                                
                                <div class="certificado-estadisticas">
                                    <div class="cert-stat">
                                        <div class="cert-stat-icon">🧮</div>
                                        <div class="cert-stat-valor" id="cert-calculos">0</div>
                                        <div class="cert-stat-label">Cálculos</div>
                                    </div>
                                    <div class="cert-stat">
                                        <div class="cert-stat-icon">✅</div>
                                        <div class="cert-stat-valor">100%</div>
                                        <div class="cert-stat-label">Completado</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="certificado-footer">
                                <div class="certificado-firma">
                                    <div class="certificado-linea-firma"></div>
                                    <p class="certificado-nombre-firma">Carlos Mario Sanjuan</p>
                                    <p class="certificado-institucion">Docente de Tecnología</p>
                                    <p class="certificado-institucion">I.E.T.I. Nuestra Señora del Rosario</p>
                                </div>
                                
                                <div class="certificado-sello">
                                    <div class="sello-circular">
                                        <div class="sello-texto">APROBADO</div>
                                        <div class="sello-anio" id="cert-anio">2025</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="certificado-codigo">
                                <p>Código: <span id="cert-codigo">OHM-2025-XXXX</span></p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="certificado-acciones">
                        <button class="btn-descargar-certificado btn-imprimir" id="btn-imprimir">
                            🖨️ Imprimir Certificado
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>
    
    <footer class="footer">
        <div class="footer-content">
            <p><strong>Ohm-Lab: Mi Laboratorio Virtual</strong> v1.0.0 | I.E.T.I. Nuestra Señora del Rosario | Grados 10° y 11°</p>
            <p>🎓 Universidad de Cartagena • Aplicaciones Móviles para la Enseñanza</p>
            <p>Docente: Beiby Rocio Gaviria Pabon | © 2025</p>
            <div class="footer-links">
                <a href="#" class="footer-link">Ayuda</a>
                <a href="#" class="footer-link">Contacto</a>
                <a href="#" class="footer-link">Privacidad</a>
            </div>
        </div>
    </footer>
    
    <script>
        const estadoPasos = {
            1: { completado: false, desbloqueado: true },
            2: { completado: false, desbloqueado: false },
            3: { completado: false, desbloqueado: false },
            4: { completado: false, desbloqueado: false }
        };
        
        let pasoActual = 1;
        let modoActual = 'mision';
        let datosEstudiante = { nombre: '', grado: '' };
        let scrollCompletado = false;
        let videoVisto = false;
        let respuestasPaso2 = {
            pregunta1: null,
            pregunta2: null,
            pregunta3: null,
            pregunta4: null,
            pregunta5: null
        };
        
        const respuestasCorrectas = {
            pregunta1: 'B',
            pregunta2: 'C',
            pregunta3: 'C',
            pregunta4: 'C',
            pregunta5: 'B'
        };
        
        const retroalimentaciones = {
            pregunta1: {
                correcta: '✅ ¡Correcto! Según la Ley de Ohm (V = I × R), el voltaje y la corriente son directamente proporcionales. Si aumentas el voltaje y la resistencia no cambia, la corriente también aumenta.',
                incorrecta: '❌ Incorrecto. Recuerda que según V = I × R, el voltaje y la corriente son directamente proporcionales cuando la resistencia permanece constante.'
            },
            pregunta2: {
                correcta: '✅ ¡Excelente! Aplicando V = I × R: V = 2 A × 50 Ω = 100 V. Has calculado correctamente el voltaje del circuito.',
                incorrecta: '❌ Incorrecto. Usa la fórmula V = I × R = 2 A × 50 Ω = 100 V. Revisa la operación matemática.'
            },
            pregunta3: {
                correcta: '✅ ¡Perfecto! La resistencia eléctrica se mide en Ohmios (Ω), en honor al físico Georg Simon Ohm quien formuló esta ley.',
                incorrecta: '❌ Incorrecto. Los Voltios (V) miden el voltaje, los Amperios (A) miden la corriente, y los Watts (W) miden la potencia. La resistencia se mide en Ohmios (Ω).'
            },
            pregunta4: {
                correcta: '✅ ¡Muy bien! Aplicando I = V ÷ R: I = 12 V ÷ 4 Ω = 3 A. Has calculado correctamente la corriente que circula por el circuito.',
                incorrecta: '❌ Incorrecto. Debes dividir el voltaje entre la resistencia: I = V ÷ R = 12 V ÷ 4 Ω = 3 A. Verifica tu operación.'
            },
            pregunta5: {
                correcta: '✅ ¡Correcto! El voltaje es como la presión del agua que impulsa el flujo. A mayor presión (voltaje), mayor flujo de agua (corriente).',
                incorrecta: '❌ Incorrecto. El ancho de la tubería representa la resistencia, la cantidad de agua que fluye es la corriente, y la fricción también es resistencia. El voltaje es la presión que impulsa el agua.'
            }
        };
        
        let formulaActual = 'V';
        let ultimoCalculo = null;
        let historialCalculos = [];
        const calculosMinimos = 3;
        
        const problemasEjemplos = [
            { contexto: 'una lámpara LED', icono: '💡' },
            { contexto: 'un ventilador', icono: '🌀' },
            { contexto: 'un cargador de celular', icono: '📱' },
            { contexto: 'un motor eléctrico', icono: '⚙️' },
            { contexto: 'una resistencia de calefacción', icono: '🔥' },
            { contexto: 'un timbre eléctrico', icono: '🔔' },
            { contexto: 'una radio portátil', icono: '📻' },
            { contexto: 'un televisor', icono: '📺' }
        ];
        
        let respuestasEvaluacion = {};
        let notaFinal = 0;
        
        const respuestasCorrectasEval = {
            eval_pregunta1: 'B',
            eval_pregunta2: 'C',
            eval_pregunta3: 'C',
            eval_pregunta4: 'B',
            eval_pregunta5: 'B',
            eval_pregunta6: 'C',
            eval_pregunta7: 'B',
            eval_pregunta8: 'C',
            eval_pregunta9: 'B',
            eval_pregunta10: 'D'
        };
        
        const retroalimentacionesEval = {
            eval_pregunta1: { correcta: '✅ Correcto! I = V/R significa directamente proporcional a V e inversamente a R.', incorrecta: '❌ Incorrecto. La fórmula I = V/R muestra relación directa con V e inversa con R.' },
            eval_pregunta2: { correcta: '✅ Excelente! I = 24V ÷ 8Ω = 3A.', incorrecta: '❌ Incorrecto. Calcula: I = V ÷ R = 24 ÷ 8 = 3A.' },
            eval_pregunta3: { correcta: '✅ Perfecto! R = 120V ÷ 0.5A = 240Ω.', incorrecta: '❌ Incorrecto. Usa R = V ÷ I = 120 ÷ 0.5 = 240Ω.' },
            eval_pregunta4: { correcta: '✅ Correcto! Si V se duplica y R es constante, I también se duplica.', incorrecta: '❌ Incorrecto. V = I × R implica que I y V son proporcionales.' },
            eval_pregunta5: { correcta: '✅ Correcto! El Voltio (V) es la unidad del voltaje.', incorrecta: '❌ Incorrecto. A=corriente, Ω=resistencia, W=potencia. Voltaje=V.' },
            eval_pregunta6: { correcta: '✅ Excelente! I = 5V ÷ 20Ω = 0.25A.', incorrecta: '❌ Incorrecto. Calcula: I = V ÷ R = 5 ÷ 20 = 0.25A.' },
            eval_pregunta7: { correcta: '✅ Correcto! La resistencia se opone al paso de la corriente.', incorrecta: '❌ Incorrecto. La resistencia NO facilita, sino que se opone.' },
            eval_pregunta8: { correcta: '✅ Perfecto! V = 3A × 15Ω = 45V.', incorrecta: '❌ Incorrecto. Usa V = I × R = 3 × 15 = 45V.' },
            eval_pregunta9: { correcta: '✅ Correcto! Si R se reduce a la mitad, I se duplica.', incorrecta: '❌ Incorrecto. I = V ÷ R, si R disminuye, I aumenta.' },
            eval_pregunta10: { correcta: '✅ Excelente! V = R ÷ I es incorrecta. La correcta es V = I × R.', incorrecta: '❌ Incorrecto. Las 3 primeras son correctas. V = R ÷ I es la incorrecta.' }
        };
        
        const textosModos = {
            mision: {
                subtitulo: 'Una aventura con los Ohm-Vengers',
                indicador: '🎮 Modo Misión Activo',
                introTitle: '¡Emergencia Eléctrica en la Ciudad!',
                introDescription: 'La ciudad ha perdido el control de su red eléctrica. Los Ohm-Vengers necesitan tu ayuda para entender cómo funciona la electricidad y restaurar el orden. Tu misión: dominar la Ley de Ohm y convertirte en un superhéroe de la electricidad.',
                objetivosTitle: 'Objetivos de tu Misión',
                registroTitle: 'Registro de Superhéroe',
                btnRegistro: 'Registrarme y Comenzar Misión'
            },
            academico: {
                subtitulo: 'Portafolio Digital de Aprendizaje',
                indicador: '📚 Modo Académico Activo',
                introTitle: 'Bienvenido al Laboratorio de Ley de Ohm',
                introDescription: 'En esta actividad educativa aprenderás los fundamentos de la electricidad mediante el estudio de la Ley de Ohm. Desarrollarás competencias en cálculo de circuitos eléctricos y comprensión de los principios físicos que rigen el comportamiento de la corriente eléctrica.',
                objetivosTitle: 'Objetivos de Aprendizaje',
                registroTitle: 'Datos del Estudiante',
                btnRegistro: 'Guardar Datos y Continuar'
            }
        };
        
        function cambiarModo(modo) {
            modoActual = modo;
            const textos = textosModos[modo];
            
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.mode === modo);
            });
            
            document.getElementById('subtitle-text').textContent = textos.subtitulo;
            document.getElementById('mode-indicator').textContent = textos.indicador;
            document.getElementById('intro-title').textContent = textos.introTitle;
            document.getElementById('intro-description').textContent = textos.introDescription;
            document.getElementById('objetivos-title').textContent = textos.objetivosTitle;
            document.getElementById('registro-title').textContent = textos.registroTitle;
            document.getElementById('btn-registro-text').textContent = textos.btnRegistro;
            
            const introBanner = document.getElementById('intro-banner');
            if (modo === 'academico') {
                introBanner.classList.add('modo-academico');
            } else {
                introBanner.classList.remove('modo-academico');
            }
            
            localStorage.setItem('ohm-lab-modo', modo);
        }
        
        function detectarScroll() {
            if (pasoActual !== 1 || scrollCompletado) return;
            
            const formulaContainer = document.querySelector('.formula-container');
            if (!formulaContainer) return;
            
            const rect = formulaContainer.getBoundingClientRect();
            const windowHeight = window.innerHeight;
            const scrolled = window.scrollY;
            const total = document.documentElement.scrollHeight - windowHeight;
            const percentage = Math.min(100, Math.max(0, (scrolled / total) * 100));
            
            const indicator = document.getElementById('scroll-indicator');
            const scrollPercentage = document.getElementById('scroll-percentage');
            
            if (scrollPercentage) {
                scrollPercentage.textContent = Math.round(percentage) + '%';
            }
            
            if (percentage < 95 && !scrollCompletado) {
                indicator.classList.add('visible');
            }
            
            if (percentage >= 95 && !scrollCompletado) {
                scrollCompletado = true;
                indicator.classList.remove('visible');
                mostrarFormulario();
            }
        }
        
        function mostrarFormulario() {
            const registroSection = document.getElementById('registro-section');
            registroSection.style.display = 'block';
            
            setTimeout(() => {
                registroSection.classList.add('visible');
                registroSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 100);
            
            mostrarAlerta('success', '🎉 ¡Excelente! Has revisado todo el contenido. Ahora regístrate para comenzar tu aventura.');
        }
        
        function validarFormulario() {
            const nombre = document.getElementById('nombre-estudiante');
            const grado = document.getElementById('grado-estudiante');
            const errorNombre = document.getElementById('error-nombre');
            const errorGrado = document.getElementById('error-grado');
            
            let valido = true;
            
            if (nombre.value.trim().length < 3) {
                nombre.classList.add('error');
                errorNombre.classList.add('visible');
                valido = false;
            } else {
                nombre.classList.remove('error');
                errorNombre.classList.remove('visible');
            }
            
            if (!grado.value) {
                grado.classList.add('error');
                errorGrado.classList.add('visible');
                valido = false;
            } else {
                grado.classList.remove('error');
                errorGrado.classList.remove('visible');
            }
            
            return valido;
        }
        
        function mostrarAlerta(tipo, mensaje) {
            const alert = document.getElementById('alert-registro');
            alert.className = `alert-box ${tipo} visible`;
            alert.textContent = mensaje;
            
            setTimeout(() => alert.classList.remove('visible'), 5000);
        }
        
        document.getElementById('form-registro').addEventListener('submit', (e) => {
            e.preventDefault();
            
            if (!validarFormulario()) {
                mostrarAlerta('error', '⚠️ Por favor completa todos los campos correctamente.');
                return;
            }
            
            datosEstudiante.nombre = document.getElementById('nombre-estudiante').value.trim();
            datosEstudiante.grado = document.getElementById('grado-estudiante').value;
            
            localStorage.setItem('ohm-lab-estudiante', JSON.stringify(datosEstudiante));
            
            completarPaso(1);
            
            mostrarAlerta('success', `✅ ¡Bienvenido/a, ${datosEstudiante.nombre}! Redirigiendo al Paso 2...`);
            
            document.getElementById('form-registro').querySelectorAll('input, select, button').forEach(el => el.disabled = true);
            
            setTimeout(() => {
                cambiarPaso(2);
            }, 1500);
        });
        
        window.addEventListener('scroll', detectarScroll);
        
        document.getElementById('video-visto').addEventListener('change', (e) => {
            videoVisto = e.target.checked;
            
            const preguntasSection = document.getElementById('preguntas-section');
            
            if (videoVisto) {
                preguntasSection.style.display = 'block';
                setTimeout(() => {
                    preguntasSection.classList.add('visible');
                    preguntasSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
                mostrarAlertaPaso2('success', '✅ ¡Perfecto! Ahora responde las 5 preguntas de comprensión para verificar tu aprendizaje.');
            } else {
                preguntasSection.classList.remove('visible');
                setTimeout(() => {
                    preguntasSection.style.display = 'none';
                }, 300);
            }
            
            verificarBotonPaso2();
            guardarProgresoPaso2();
        });
        
        for (let i = 1; i <= 5; i++) {
            const radios = document.querySelectorAll(`input[name="pregunta${i}"]`);
            radios.forEach(radio => {
                radio.addEventListener('change', (e) => {
                    validarPregunta(i, e.target.value);
                });
            });
        }
        
        document.getElementById('form-preguntas').addEventListener('submit', (e) => {
            e.preventDefault();
            
            if (!videoVisto) {
                mostrarAlertaPaso2('error', '⚠️ Primero debes ver el video y marcarlo como visto.');
                window.scrollTo({ top: 0, behavior: 'smooth' });
                return;
            }
            
            let todasRespondidas = true;
            for (let i = 1; i <= 5; i++) {
                if (!respuestasPaso2[`pregunta${i}`]) {
                    todasRespondidas = false;
                    mostrarAlertaPaso2('error', `⚠️ Por favor responde la pregunta ${i} antes de continuar.`);
                    break;
                }
            }
            
            if (!todasRespondidas) return;
            
            let correctas = 0;
            for (let i = 1; i <= 5; i++) {
                if (respuestasPaso2[`pregunta${i}`] === respuestasCorrectas[`pregunta${i}`]) {
                    correctas++;
                }
            }
            
            guardarProgresoPaso2();
            completarPaso(2);
            
            const porcentaje = (correctas / 5) * 100;
            mostrarAlertaPaso2('success', `✅ ¡Excelente! Has completado el Paso 2. Obtuviste ${correctas} de 5 respuestas correctas (${porcentaje}%). Redirigiendo al Paso 3...`);
            
            document.querySelectorAll('#form-preguntas input[type="radio"]').forEach(radio => radio.disabled = true);
            document.getElementById('video-visto').disabled = true;
            document.getElementById('btn-completar-paso2').disabled = true;
            
            setTimeout(() => {
                cambiarPaso(3);
            }, 2000);
        });
        
        function validarPregunta(numeroPregunta, respuestaSeleccionada) {
            respuestasPaso2[`pregunta${numeroPregunta}`] = respuestaSeleccionada;
            
            const esCorrecta = respuestaSeleccionada === respuestasCorrectas[`pregunta${numeroPregunta}`];
            
            const retroalimentacion = document.getElementById(`retro-pregunta-${numeroPregunta}`);
            if (retroalimentacion) {
                retroalimentacion.className = `retroalimentacion visible ${esCorrecta ? 'correcta' : 'incorrecta'}`;
                
                const mensajeRetro = retroalimentaciones[`pregunta${numeroPregunta}`];
                if (mensajeRetro) {
                    retroalimentacion.textContent = esCorrecta ? mensajeRetro.correcta : mensajeRetro.incorrecta;
                }
            }
            
            const opciones = document.querySelectorAll(`input[name="pregunta${numeroPregunta}"]`);
            opciones.forEach(opcion => {
                const opcionItem = opcion.closest('.opcion-item');
                if (opcionItem) {
                    opcionItem.classList.remove('correcta', 'incorrecta');
                    
                    if (opcion.checked) {
                        opcionItem.classList.add(esCorrecta ? 'correcta' : 'incorrecta');
                    }
                }
            });
            
            verificarBotonPaso2();
            guardarProgresoPaso2();
        }
        
        function verificarBotonPaso2() {
            const btnCompletarPaso2 = document.getElementById('btn-completar-paso2');
            if (!btnCompletarPaso2) return;
            
            if (!videoVisto) {
                btnCompletarPaso2.disabled = true;
                return;
            }
            
            let todasRespondidas = true;
            for (let i = 1; i <= 5; i++) {
                if (!respuestasPaso2[`pregunta${i}`]) {
                    todasRespondidas = false;
                    break;
                }
            }
            
            btnCompletarPaso2.disabled = !todasRespondidas;
        }
        
        function mostrarAlertaPaso2(tipo, mensaje) {
            const alert = document.getElementById('alert-paso2');
            if (!alert) return;
            
            alert.className = `alert-box ${tipo} visible`;
            alert.textContent = mensaje;
            
            setTimeout(() => alert.classList.remove('visible'), 6000);
        }
        
        function guardarProgresoPaso2() {
            const progresoPaso2 = {
                videoVisto: videoVisto,
                respuestas: respuestasPaso2
            };
            
            localStorage.setItem('ohm-lab-paso2', JSON.stringify(progresoPaso2));
        }
        
        function cargarProgresoPaso2() {
            const progresoGuardado = localStorage.getItem('ohm-lab-paso2');
            
            if (progresoGuardado) {
                const progreso = JSON.parse(progresoGuardado);
                
                if (progreso.videoVisto) {
                    videoVisto = true;
                    const videoVistoCheckbox = document.getElementById('video-visto');
                    if (videoVistoCheckbox) {
                        videoVistoCheckbox.checked = true;
                    }
                    
                    const preguntasSection = document.getElementById('preguntas-section');
                    if (preguntasSection) {
                        preguntasSection.style.display = 'block';
                        preguntasSection.classList.add('visible');
                    }
                }
                
                if (progreso.respuestas) {
                    respuestasPaso2 = progreso.respuestas;
                    
                    Object.keys(progreso.respuestas).forEach(key => {
                        const numeroPregunta = key.replace('pregunta', '');
                        const respuesta = progreso.respuestas[key];
                        
                        if (respuesta) {
                            const radio = document.querySelector(`input[name="pregunta${numeroPregunta}"][value="${respuesta}"]`);
                            if (radio) {
                                radio.checked = true;
                                validarPregunta(parseInt(numeroPregunta), respuesta);
                            }
                        }
                    });
                }
                
                if (estadoPasos[2].completado) {
                    document.querySelectorAll('#form-preguntas input[type="radio"]').forEach(radio => radio.disabled = true);
                    const videoVistoCheckbox = document.getElementById('video-visto');
                    if (videoVistoCheckbox) videoVistoCheckbox.disabled = true;
                    document.getElementById('btn-completar-paso2').disabled = true;
                    
                    const preguntasSection = document.getElementById('preguntas-section');
                    if (preguntasSection) {
                        preguntasSection.style.display = 'block';
                        preguntasSection.classList.add('visible');
                    }
                    
                    mostrarAlertaPaso2('success', '✅ Ya completaste este paso anteriormente.');
                }
            }
        }
        
        function actualizarProgreso() {
            const completados = Object.values(estadoPasos).filter(p => p.completado).length;
            const porcentaje = Math.round((completados / 4) * 100);
            
            document.getElementById('progress-percentage').textContent = `${porcentaje}%`;
            document.getElementById('progress-bar-fill').style.width = `${porcentaje}%`;
        }
        
        function actualizarTabs() {
            document.querySelectorAll('.step-tab').forEach(tab => {
                const num = parseInt(tab.dataset.step);
                const paso = estadoPasos[num];
                const status = tab.querySelector('.step-status');
                
                tab.classList.remove('active', 'completed', 'locked');
                
                if (num === pasoActual) {
                    tab.classList.add('active');
                    status.textContent = '🔵';
                } else if (paso.completado) {
                    tab.classList.add('completed');
                    status.textContent = '✅';
                } else if (paso.desbloqueado) {
                    status.textContent = '⭕';
                } else {
                    tab.classList.add('locked');
                    status.textContent = '🔒';
                }
            });
        }
        
        function cambiarPaso(num) {
            if (!estadoPasos[num].desbloqueado) {
                alert('⚠️ Debes completar el paso actual primero.');
                return;
            }
            
            document.querySelectorAll('.step-section').forEach(s => s.classList.remove('active'));
            document.getElementById(`paso${num}`).classList.add('active');
            
            pasoActual = num;
            actualizarTabs();
            actualizarBotones();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function actualizarBotones() {
            document.getElementById('btn-anterior').disabled = pasoActual === 1;
            document.getElementById('btn-siguiente').disabled = pasoActual === 4 || !estadoPasos[pasoActual + 1]?.desbloqueado;
        }
        
        function completarPaso(num) {
            estadoPasos[num].completado = true;
            if (num < 4) estadoPasos[num + 1].desbloqueado = true;
            
            actualizarTabs();
            actualizarBotones();
            actualizarProgreso();
            guardarProgreso();
        }
        
        function guardarProgreso() {
            localStorage.setItem('ohm-lab-progreso', JSON.stringify({
                pasoActual,
                estadoPasos,
                modoActual
            }));
        }
        
        function cargarProgreso() {
            const guardado = localStorage.getItem('ohm-lab-progreso');
            if (guardado) {
                const datos = JSON.parse(guardado);
                pasoActual = datos.pasoActual || 1;
                Object.assign(estadoPasos, datos.estadoPasos);
                if (datos.modoActual) cambiarModo(datos.modoActual);
                cambiarPaso(pasoActual);
            }
            
            const modoGuardado = localStorage.getItem('ohm-lab-modo');
            if (modoGuardado) cambiarModo(modoGuardado);
            
            const estudianteGuardado = localStorage.getItem('ohm-lab-estudiante');
            if (estudianteGuardado) {
                datosEstudiante = JSON.parse(estudianteGuardado);
                document.getElementById('nombre-estudiante').value = datosEstudiante.nombre;
                document.getElementById('grado-estudiante').value = datosEstudiante.grado;
                
                if (estadoPasos[1].completado) {
                    scrollCompletado = true;
                    const registroSection = document.getElementById('registro-section');
                    registroSection.style.display = 'block';
                    registroSection.classList.add('visible');
                    document.getElementById('form-registro').querySelectorAll('input, select, button').forEach(el => el.disabled = true);
                    mostrarAlerta('success', `✅ Bienvenido/a de nuevo, ${datosEstudiante.nombre}!`);
                }
            }
        }
        
        function reiniciar() {
            if (confirm('¿Seguro que deseas reiniciar todo el progreso?')) {
                localStorage.clear();
                location.reload();
            }
        }
        
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.addEventListener('click', () => cambiarModo(btn.dataset.mode));
        });
        
        document.querySelectorAll('.step-tab').forEach(tab => {
            tab.addEventListener('click', () => cambiarPaso(parseInt(tab.dataset.step)));
        });
        
        document.getElementById('btn-anterior').addEventListener('click', () => {
            if (pasoActual > 1) cambiarPaso(pasoActual - 1);
        });
        
        document.getElementById('btn-siguiente').addEventListener('click', () => {
            if (pasoActual < 4) cambiarPaso(pasoActual + 1);
        });
        
        document.getElementById('btn-reset').addEventListener('click', reiniciar);
        
        window.addEventListener('DOMContentLoaded', () => {
            cargarProgreso();
            actualizarProgreso();
            cargarProgresoPaso2();
            inicializarPaso3();
            inicializarPaso4();
        });
        
        function inicializarPaso4() {
            const formEvaluacion = document.getElementById('form-evaluacion-final');
            if (!formEvaluacion) return;
            
            for (let i = 1; i <= 10; i++) {
                const radios = document.querySelectorAll(`input[name="eval_pregunta${i}"]`);
                radios.forEach(radio => {
                    radio.addEventListener('change', (e) => {
                        validarPreguntaEval(i, e.target.value);
                    });
                });
            }
            
            formEvaluacion.addEventListener('submit', (e) => {
                e.preventDefault();
                procesarEvaluacionFinal();
            });
            
            const btnImprimir = document.getElementById('btn-imprimir');
            if (btnImprimir) {
                btnImprimir.addEventListener('click', () => window.print());
            }
            
            cargarProgresoPaso4();
        }
        
        function validarPreguntaEval(numeroPregunta, respuestaSeleccionada) {
            const nombrePregunta = `eval_pregunta${numeroPregunta}`;
            respuestasEvaluacion[nombrePregunta] = respuestaSeleccionada;
            
            const esCorrecta = respuestaSeleccionada === respuestasCorrectasEval[nombrePregunta];
            
            const retroalimentacion = document.getElementById(`eval-retro-${numeroPregunta}`);
            if (retroalimentacion) {
                retroalimentacion.className = `retroalimentacion visible ${esCorrecta ? 'correcta' : 'incorrecta'}`;
                const mensajeRetro = retroalimentacionesEval[nombrePregunta];
                if (mensajeRetro) {
                    retroalimentacion.textContent = esCorrecta ? mensajeRetro.correcta : mensajeRetro.incorrecta;
                }
            }
            
            const opciones = document.querySelectorAll(`input[name="${nombrePregunta}"]`);
            opciones.forEach(opcion => {
                const opcionItem = opcion.closest('.opcion-item');
                if (opcionItem) {
                    opcionItem.classList.remove('correcta', 'incorrecta');
                    if (opcion.checked) {
                        opcionItem.classList.add(esCorrecta ? 'correcta' : 'incorrecta');
                    }
                }
            });
            
            guardarProgresoPaso4();
        }
        
        function procesarEvaluacionFinal() {
            let todasRespondidas = true;
            for (let i = 1; i <= 10; i++) {
                if (!respuestasEvaluacion[`eval_pregunta${i}`]) {
                    todasRespondidas = false;
                    mostrarAlertaPaso4('error', `⚠️ Por favor responde la pregunta ${i}.`);
                    return;
                }
            }
            
            if (!todasRespondidas) return;
            
            let correctas = 0;
            for (let i = 1; i <= 10; i++) {
                if (respuestasEvaluacion[`eval_pregunta${i}`] === respuestasCorrectasEval[`eval_pregunta${i}`]) {
                    correctas++;
                }
            }
            
            notaFinal = correctas;
            const porcentaje = (correctas / 10) * 100;
            const aprobado = porcentaje >= 70;
            
            guardarProgresoPaso4();
            
            document.querySelectorAll('#form-evaluacion-final input[type="radio"]').forEach(radio => radio.disabled = true);
            document.getElementById('btn-completar-paso4').disabled = true;
            
            if (aprobado) {
                completarPaso(4);
                mostrarAlertaPaso4('success', `🎉 ¡APROBASTE! ${correctas}/10 (${porcentaje}%). Tu certificado está listo.`);
                
                setTimeout(() => {
                    generarCertificado(correctas);
                }, 1500);
            } else {
                mostrarAlertaPaso4('error', `😔 Obtuviste ${correctas}/10 (${porcentaje}%). Necesitas 70% para aprobar.`);
            }
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function generarCertificado(correctas) {
            const certificadoSection = document.getElementById('certificado-section');
            const evaluacionFinal = document.getElementById('evaluacion-final');
            
            if (!certificadoSection || !evaluacionFinal) return;
            
            evaluacionFinal.style.display = 'none';
            certificadoSection.classList.add('visible');
            
            document.getElementById('cert-nombre-estudiante').textContent = datosEstudiante.nombre || 'Estudiante';
            document.getElementById('cert-grado').textContent = datosEstudiante.grado ? `${datosEstudiante.grado}°` : '10°';
            
            const fechaActual = new Date();
            document.getElementById('cert-fecha').textContent = fechaActual.toLocaleDateString('es-CO', { day: 'numeric', month: 'long', year: 'numeric' });
            document.getElementById('cert-calificacion').textContent = `${correctas}/10`;
            document.getElementById('cert-calculos').textContent = historialCalculos.length.toString();
            document.getElementById('cert-anio').textContent = fechaActual.getFullYear().toString();
            document.getElementById('cert-codigo').textContent = `OHM-${fechaActual.getFullYear()}-${Math.random().toString(36).substr(2, 8).toUpperCase()}`;
            
            document.getElementById('cert-nota-felicitacion').textContent = `${correctas}/10`;
            document.getElementById('cert-calculos-felicitacion').textContent = historialCalculos.length.toString();
            
            setTimeout(() => {
                certificadoSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 1000);
        }
        
        function mostrarAlertaPaso4(tipo, mensaje) {
            const alert = document.getElementById('alert-paso4');
            if (!alert) return;
            
            alert.className = `alert-box ${tipo} visible`;
            alert.textContent = mensaje;
            
            setTimeout(() => alert.classList.remove('visible'), 8000);
        }
        
        function guardarProgresoPaso4() {
            const progresoPaso4 = {
                respuestas: respuestasEvaluacion,
                notaFinal: notaFinal
            };
            
            localStorage.setItem('ohm-lab-paso4', JSON.stringify(progresoPaso4));
        }
        
        function cargarProgresoPaso4() {
            const progresoGuardado = localStorage.getItem('ohm-lab-paso4');
            
            if (progresoGuardado) {
                const progreso = JSON.parse(progresoGuardado);
                
                if (progreso.respuestas) {
                    respuestasEvaluacion = progreso.respuestas;
                    
                    Object.keys(progreso.respuestas).forEach(nombrePregunta => {
                        const numeroPregunta = nombrePregunta.replace('eval_pregunta', '');
                        const respuesta = progreso.respuestas[nombrePregunta];
                        
                        if (respuesta) {
                            const radio = document.querySelector(`input[name="${nombrePregunta}"][value="${respuesta}"]`);
                            if (radio) {
                                radio.checked = true;
                                validarPreguntaEval(parseInt(numeroPregunta), respuesta);
                            }
                        }
                    });
                }
                
                if (estadoPasos[4].completado && progreso.notaFinal) {
                    notaFinal = progreso.notaFinal;
                    
                    document.querySelectorAll('#form-evaluacion-final input[type="radio"]').forEach(radio => radio.disabled = true);
                    document.getElementById('btn-completar-paso4').disabled = true;
                    
                    if (notaFinal >= 7) {
                        setTimeout(() => {
                            generarCertificado(notaFinal);
                        }, 500);
                    }
                    
                    mostrarAlertaPaso4('success', '✅ Ya completaste la evaluación anteriormente.');
                }
            }
        }
        
        function inicializarPaso3() {
            const botonesFormula = document.querySelectorAll('.formula-btn');
            const formCalculadora = document.getElementById('form-calculadora');
            const btnAgregarHistorial = document.getElementById('btn-agregar-historial');
            const btnLimpiarHistorial = document.getElementById('btn-limpiar-historial');
            const btnExportarPortafolio = document.getElementById('btn-exportar-portafolio');
            const btnCompletarPaso3 = document.getElementById('btn-completar-paso3');
            const btnModoPractica = document.getElementById('btn-modo-practica');
            
            if (!formCalculadora) return;
            
            botonesFormula.forEach(btn => {
                btn.addEventListener('click', () => {
                    botonesFormula.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    formulaActual = btn.dataset.formula;
                    actualizarInputsCalculadora();
                    document.getElementById('resultado-container').classList.remove('visible');
                });
            });
            
            formCalculadora.addEventListener('submit', (e) => {
                e.preventDefault();
                realizarCalculo();
            });
            
            if (btnAgregarHistorial) {
                btnAgregarHistorial.addEventListener('click', () => {
                    if (ultimoCalculo) {
                        agregarAlHistorial(ultimoCalculo);
                        mostrarAlertaPaso3('success', '✅ Cálculo agregado a tu portafolio exitosamente.');
                    }
                });
            }
            
            if (btnLimpiarHistorial) {
                btnLimpiarHistorial.addEventListener('click', () => {
                    if (confirm('¿Estás seguro de que deseas eliminar todos los cálculos?')) {
                        historialCalculos = [];
                        renderizarHistorial();
                        guardarProgresoPaso3();
                        mostrarAlertaPaso3('success', '🗑️ Portafolio limpiado.');
                    }
                });
            }
            
            if (btnExportarPortafolio) {
                btnExportarPortafolio.addEventListener('click', () => {
                    exportarPortafolio();
                });
            }
            
            if (btnCompletarPaso3) {
                btnCompletarPaso3.addEventListener('click', () => {
                    if (historialCalculos.length < calculosMinimos) {
                        mostrarAlertaPaso3('error', `⚠️ Debes realizar y guardar al menos ${calculosMinimos} cálculos. Llevas ${historialCalculos.length}/${calculosMinimos}.`);
                        return;
                    }
                    
                    completarPaso(3);
                    mostrarAlertaPaso3('success', '✅ ¡Excelente trabajo! Has completado el Paso 3. Redirigiendo al Paso 4...');
                    btnCompletarPaso3.disabled = true;
                    
                    setTimeout(() => {
                        cambiarPaso(4);
                    }, 2000);
                });
            }
            
            if (btnModoPractica) {
                btnModoPractica.addEventListener('click', () => {
                    generarProblemaAleatorio();
                });
            }
            
            cargarProgresoPaso3();
        }
        
        function actualizarInputsCalculadora() {
            const inputsContainer = document.getElementById('inputs-container');
            let html = '';
            
            if (formulaActual === 'V') {
                html = `
                    <div class="input-group">
                        <label for="input-I">Corriente (I) <span style="color: var(--color-error);">*</span></label>
                        <div class="input-wrapper">
                            <input type="number" id="input-I" step="0.01" placeholder="Ej: 2.5" required>
                            <span class="unidad">A</span>
                        </div>
                    </div>
                    <div class="input-group">
                        <label for="input-R">Resistencia (R) <span style="color: var(--color-error);">*</span></label>
                        <div class="input-wrapper">
                            <input type="number" id="input-R" step="0.01" placeholder="Ej: 100" required>
                            <span class="unidad">Ω</span>
                        </div>
                    </div>
                `;
            } else if (formulaActual === 'I') {
                html = `
                    <div class="input-group">
                        <label for="input-V">Voltaje (V) <span style="color: var(--color-error);">*</span></label>
                        <div class="input-wrapper">
                            <input type="number" id="input-V" step="0.01" placeholder="Ej: 12" required>
                            <span class="unidad">V</span>
                        </div>
                    </div>
                    <div class="input-group">
                        <label for="input-R">Resistencia (R) <span style="color: var(--color-error);">*</span></label>
                        <div class="input-wrapper">
                            <input type="number" id="input-R" step="0.01" placeholder="Ej: 100" required>
                            <span class="unidad">Ω</span>
                        </div>
                    </div>
                `;
            } else {
                html = `
                    <div class="input-group">
                        <label for="input-V">Voltaje (V) <span style="color: var(--color-error);">*</span></label>
                        <div class="input-wrapper">
                            <input type="number" id="input-V" step="0.01" placeholder="Ej: 12" required>
                            <span class="unidad">V</span>
                        </div>
                    </div>
                    <div class="input-group">
                        <label for="input-I">Corriente (I) <span style="color: var(--color-error);">*</span></label>
                        <div class="input-wrapper">
                            <input type="number" id="input-I" step="0.01" placeholder="Ej: 2.5" required>
                            <span class="unidad">A</span>
                        </div>
                    </div>
                `;
            }
            
            inputsContainer.innerHTML = html;
        }
        
        function realizarCalculo() {
            let resultado, formula, detalles;
            
            if (formulaActual === 'V') {
                const I = parseFloat(document.getElementById('input-I').value);
                const R = parseFloat(document.getElementById('input-R').value);
                
                if (isNaN(I) || isNaN(R) || I <= 0 || R <= 0) {
                    mostrarAlertaPaso3('error', '⚠️ Por favor ingresa valores válidos mayores a cero.');
                    return;
                }
                
                resultado = I * R;
                formula = `V = ${I} A × ${R} Ω`;
                detalles = `I = ${I} A, R = ${R} Ω`;
                
                document.getElementById('resultado-valor').textContent = `${resultado.toFixed(2)} V`;
                document.getElementById('resultado-formula').textContent = formula;
            } else if (formulaActual === 'I') {
                const V = parseFloat(document.getElementById('input-V').value);
                const R = parseFloat(document.getElementById('input-R').value);
                
                if (isNaN(V) || isNaN(R) || V <= 0 || R <= 0) {
                    mostrarAlertaPaso3('error', '⚠️ Por favor ingresa valores válidos mayores a cero.');
                    return;
                }
                
                resultado = V / R;
                formula = `I = ${V} V ÷ ${R} Ω`;
                detalles = `V = ${V} V, R = ${R} Ω`;
                
                document.getElementById('resultado-valor').textContent = `${resultado.toFixed(2)} A`;
                document.getElementById('resultado-formula').textContent = formula;
            } else {
                const V = parseFloat(document.getElementById('input-V').value);
                const I = parseFloat(document.getElementById('input-I').value);
                
                if (isNaN(V) || isNaN(I) || V <= 0 || I <= 0) {
                    mostrarAlertaPaso3('error', '⚠️ Por favor ingresa valores válidos mayores a cero.');
                    return;
                }
                
                resultado = V / I;
                formula = `R = ${V} V ÷ ${I} A`;
                detalles = `V = ${V} V, I = ${I} A`;
                
                document.getElementById('resultado-valor').textContent = `${resultado.toFixed(2)} Ω`;
                document.getElementById('resultado-formula').textContent = formula;
            }
            
            ultimoCalculo = {
                tipo: formulaActual,
                resultado: resultado.toFixed(2),
                formula: formula,
                detalles: detalles,
                timestamp: new Date().toISOString()
            };
            
            document.getElementById('resultado-container').classList.add('visible');
            document.getElementById('resultado-container').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        function agregarAlHistorial(calculo) {
            historialCalculos.unshift(calculo);
            renderizarHistorial();
            guardarProgresoPaso3();
            
            if (historialCalculos.length >= calculosMinimos) {
                document.getElementById('btn-completar-paso3').disabled = false;
            }
        }
        
        function renderizarHistorial() {
            const historialLista = document.getElementById('historial-lista');
            const estadisticasPanel = document.getElementById('estadisticas-panel');
            const btnExportar = document.getElementById('btn-exportar-portafolio');
            
            if (historialCalculos.length === 0) {
                historialLista.innerHTML = `
                    <div class="historial-vacio">
                        <div class="historial-vacio-icon">📊</div>
                        <p>Aún no has guardado ningún cálculo.</p>
                        <p style="font-size: 0.875rem; margin-top: var(--espaciado-xs);">
                            Realiza un cálculo y agrégalo a tu portafolio.
                        </p>
                    </div>
                `;
                
                if (estadisticasPanel) estadisticasPanel.classList.remove('visible');
                if (btnExportar) btnExportar.disabled = true;
                return;
            }
            
            if (btnExportar) btnExportar.disabled = false;
            if (estadisticasPanel) {
                estadisticasPanel.classList.add('visible');
                actualizarEstadisticas();
            }
            
            let html = '';
            historialCalculos.forEach((calculo, index) => {
                const unidad = calculo.tipo === 'V' ? 'V' : calculo.tipo === 'I' ? 'A' : 'Ω';
                const fecha = new Date(calculo.timestamp).toLocaleString('es-CO', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                html += `
                    <div class="historial-item">
                        <div class="historial-info">
                            <div>
                                <span class="historial-numero">${historialCalculos.length - index}</span>
                                <span class="historial-formula">${calculo.formula} = ${calculo.resultado} ${unidad}</span>
                            </div>
                            <div class="historial-detalles">
                                ${calculo.detalles} · ${fecha}
                            </div>
                        </div>
                        <button class="btn-eliminar-item" onclick="eliminarCalculoHistorial(${index})">
                            🗑️
                        </button>
                    </div>
                `;
            });
            
            historialLista.innerHTML = html;
        }
        
        function actualizarEstadisticas() {
            const totalCalculos = document.getElementById('total-calculos');
            const formulaFavorita = document.getElementById('formula-favorita');
            const ultimoCalculo = document.getElementById('ultimo-calculo');
            
            if (totalCalculos) {
                totalCalculos.textContent = historialCalculos.length;
            }
            
            if (formulaFavorita && historialCalculos.length > 0) {
                const conteo = {};
                historialCalculos.forEach(c => {
                    conteo[c.tipo] = (conteo[c.tipo] || 0) + 1;
                });
                
                let maxTipo = '';
                let maxConteo = 0;
                for (const tipo in conteo) {
                    if (conteo[tipo] > maxConteo) {
                        maxConteo = conteo[tipo];
                        maxTipo = tipo;
                    }
                }
                
                const nombreFormula = maxTipo === 'V' ? 'V' : maxTipo === 'I' ? 'I' : 'R';
                formulaFavorita.textContent = nombreFormula;
            }
            
            if (ultimoCalculo && historialCalculos.length > 0) {
                const ultimaFecha = new Date(historialCalculos[0].timestamp);
                const ahora = new Date();
                const diffMs = ahora - ultimaFecha;
                const diffMins = Math.floor(diffMs / 60000);
                
                if (diffMins < 1) {
                    ultimoCalculo.textContent = 'Ahora';
                } else if (diffMins < 60) {
                    ultimoCalculo.textContent = `${diffMins}m`;
                } else {
                    const diffHours = Math.floor(diffMins / 60);
                    ultimoCalculo.textContent = `${diffHours}h`;
                }
            }
        }
        
        function generarProblemaAleatorio() {
            const btnModoPractica = document.getElementById('btn-modo-practica');
            const problemaDiv = document.getElementById('problema-aleatorio');
            
            if (!problemaDiv) return;
            
            btnModoPractica.textContent = '🔄 Generar Otro Problema';
            
            const tipos = ['V', 'I', 'R'];
            const tipoAleatorio = tipos[Math.floor(Math.random() * tipos.length)];
            const contexto = problemasEjemplos[Math.floor(Math.random() * problemasEjemplos.length)];
            
            let problema, solucion, valor1, valor2, resultado;
            
            if (tipoAleatorio === 'V') {
                valor1 = (Math.random() * 5 + 0.5).toFixed(2);
                valor2 = Math.floor(Math.random() * 200 + 10);
                resultado = (parseFloat(valor1) * valor2).toFixed(2);
                
                problema = `${contexto.icono} Tienes ${contexto.contexto} que consume una corriente de <strong>${valor1} A</strong> y tiene una resistencia de <strong>${valor2} Ω</strong>. ¿Cuál es el voltaje necesario?`;
                solucion = `V = I × R = ${valor1} A × ${valor2} Ω = <strong>${resultado} V</strong>`;
            } else if (tipoAleatorio === 'I') {
                valor1 = Math.floor(Math.random() * 220 + 12);
                valor2 = Math.floor(Math.random() * 200 + 10);
                resultado = (valor1 / valor2).toFixed(2);
                
                problema = `${contexto.icono} Conectas ${contexto.contexto} a una fuente de <strong>${valor1} V</strong> y tiene una resistencia de <strong>${valor2} Ω</strong>. ¿Cuál es la corriente que circula?`;
                solucion = `I = V ÷ R = ${valor1} V ÷ ${valor2} Ω = <strong>${resultado} A</strong>`;
            } else {
                valor1 = Math.floor(Math.random() * 220 + 12);
                valor2 = (Math.random() * 5 + 0.5).toFixed(2);
                resultado = (valor1 / parseFloat(valor2)).toFixed(2);
                
                problema = `${contexto.icono} Mides ${contexto.contexto} y encuentras que funciona con <strong>${valor1} V</strong> y consume <strong>${valor2} A</strong>. ¿Cuál es su resistencia?`;
                solucion = `R = V ÷ I = ${valor1} V ÷ ${valor2} A = <strong>${resultado} Ω</strong>`;
            }
            
            problemaDiv.innerHTML = `
                <div class="problema-icono">${contexto.icono}</div>
                <div class="problema-texto">${problema}</div>
                <button class="btn-resolver-practica" onclick="mostrarSolucion()">
                    💡 Ver Solución
                </button>
                <div class="problema-respuesta" id="problema-respuesta">
                    <div class="problema-solucion">${solucion}</div>
                    <p style="margin-top: 12px; font-size: 14px; color: #065f46;">
                        💡 <strong>Consejo:</strong> Intenta resolver el problema por tu cuenta antes de ver la solución.
                    </p>
                </div>
            `;
            
            problemaDiv.classList.add('visible');
            setTimeout(() => {
                problemaDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 100);
        }
        
        function mostrarSolucion() {
            const respuestaDiv = document.getElementById('problema-respuesta');
            if (respuestaDiv) {
                respuestaDiv.classList.add('visible');
            }
        }
        
        function eliminarCalculoHistorial(index) {
            if (confirm('¿Deseas eliminar este cálculo?')) {
                historialCalculos.splice(index, 1);
                renderizarHistorial();
                guardarProgresoPaso3();
                mostrarAlertaPaso3('success', '🗑️ Cálculo eliminado.');
                
                if (historialCalculos.length < calculosMinimos) {
                    const btnCompletarPaso3 = document.getElementById('btn-completar-paso3');
                    if (btnCompletarPaso3) btnCompletarPaso3.disabled = true;
                }
            }
        }
        
        function exportarPortafolio() {
            if (historialCalculos.length === 0) {
                alert('⚠️ No hay cálculos para exportar.');
                return;
            }
            
            const fechaActual = new Date().toLocaleDateString('es-CO', { 
                day: '2-digit', 
                month: 'long', 
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            let contenidoHTML = `
                <!DOCTYPE html>
                <html lang="es">
                <head>
                    <meta charset="UTF-8">
                    <title>Mi Portafolio - Ley de Ohm</title>
                    <style>
                        body { font-family: Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
                        .contenedor { background: white; padding: 40px; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
                        h1 { color: #667eea; text-align: center; }
                        .info-estudiante { background: #f0f9ff; padding: 20px; border-radius: 12px; margin-bottom: 30px; border: 2px solid #bae6fd; }
                        .calculo-item { background: #f3f4f6; padding: 20px; border-radius: 12px; border-left: 5px solid #667eea; margin-bottom: 15px; }
                        .calculo-formula { font-size: 18px; font-weight: bold; color: #1e3a8a; font-family: 'Courier New', monospace; }
                    </style>
                </head>
                <body>
                    <div class="contenedor">
                        <h1>⚡ Mi Portafolio de Cálculos - Ley de Ohm</h1>
                        <div class="info-estudiante">
                            <p><strong>👤 Estudiante:</strong> ${datosEstudiante.nombre || 'No registrado'}</p>
                            <p><strong>📚 Grado:</strong> ${datosEstudiante.grado ? datosEstudiante.grado + '°' : 'No registrado'}</p>
                            <p><strong>📅 Fecha:</strong> ${fechaActual}</p>
                            <p><strong>📊 Total:</strong> ${historialCalculos.length} cálculos</p>
                        </div>
                        <h2 style="color: #667eea;">📋 Mis Cálculos</h2>
            `;
            
            historialCalculos.forEach((calculo, index) => {
                const unidad = calculo.tipo === 'V' ? 'V' : calculo.tipo === 'I' ? 'A' : 'Ω';
                const fecha = new Date(calculo.timestamp).toLocaleString('es-CO');
                
                contenidoHTML += `
                    <div class="calculo-item">
                        <span class="calculo-formula">${historialCalculos.length - index}. ${calculo.formula} = ${calculo.resultado} ${unidad}</span>
                        <div style="font-size: 14px; color: #64748b; margin-top: 8px;">${calculo.detalles} · ${fecha}</div>
                    </div>
                `;
            });
            
            contenidoHTML += `
                    </div>
                </body>
                </html>
            `;
            
            const blob = new Blob([contenidoHTML], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Portafolio_LeyDeOhm_${datosEstudiante.nombre || 'Estudiante'}_${new Date().getTime()}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            mostrarAlertaPaso3('success', '✅ Portafolio exportado exitosamente.');
        }
        
        function mostrarAlertaPaso3(tipo, mensaje) {
            const alert = document.getElementById('alert-paso3');
            if (!alert) return;
            
            alert.className = `alert-box ${tipo} visible`;
            alert.textContent = mensaje;
            
            setTimeout(() => alert.classList.remove('visible'), 6000);
        }
        
        function guardarProgresoPaso3() {
            const progresoPaso3 = {
                formulaActual: formulaActual,
                ultimoCalculo: ultimoCalculo,
                historialCalculos: historialCalculos
            };
            
            localStorage.setItem('ohm-lab-paso3', JSON.stringify(progresoPaso3));
        }
        
        function cargarProgresoPaso3() {
            const progresoGuardado = localStorage.getItem('ohm-lab-paso3');
            
            if (progresoGuardado) {
                const progreso = JSON.parse(progresoGuardado);
                
                if (progreso.formulaActual) {
                    formulaActual = progreso.formulaActual;
                }
                
                if (progreso.ultimoCalculo) {
                    ultimoCalculo = progreso.ultimoCalculo;
                }
                
                if (progreso.historialCalculos) {
                    historialCalculos = progreso.historialCalculos;
                    renderizarHistorial();
                    
                    const btnCompletarPaso3 = document.getElementById('btn-completar-paso3');
                    if (btnCompletarPaso3 && historialCalculos.length >= calculosMinimos) {
                        btnCompletarPaso3.disabled = false;
                    }
                }
                
                if (estadoPasos[3].completado) {
                    const btnCompletarPaso3 = document.getElementById('btn-completar-paso3');
                    if (btnCompletarPaso3) btnCompletarPaso3.disabled = true;
                    mostrarAlertaPaso3('success', '✅ Ya completaste este paso anteriormente.');
                }
            }
        }
        
        window.eliminarCalculoHistorial = eliminarCalculoHistorial;
        window.mostrarSolucion = mostrarSolucion;
        
        window.completarPaso = completarPaso;
    </script>
</body>
</html>